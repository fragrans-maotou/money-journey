const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/Dashboard-CnUWrhp4.js","js/vue-vendor-GQR5GLLq.js","js/useBudget-BWijnOHX.js","js/useStorage-CghUNedP.js","js/useExpense-oBx4eHDE.js","assets/Dashboard-C7_sKI2s.css","js/BudgetSettings-a7DAA22w.js","js/AmountInput-kU8B6T6k.js","assets/AmountInput-CJJLYkDj.css","assets/BudgetSettings-q5eR5YGu.css","js/ExpenseRecord-AQTDNhG_.js","assets/ExpenseRecord-Cffu29e_.css","js/Statistics-Df3oNLDc.js","assets/Statistics-DgLrVrIc.css","js/ExpenseHistory-BG0RMa_4.js","assets/ExpenseHistory-DF9Z706e.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,o=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&i(e,a,t[a]);return e},l=(e,n)=>t(e,a(n)),c=(e,t,a)=>new Promise((n,r)=>{var s=e=>{try{o(a.next(e))}catch(t){r(t)}},i=e=>{try{o(a.throw(e))}catch(t){r(t)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,i);o((a=a.apply(e,t)).next())});import{r as u,o as d,a as h,b as m,u as g,c as p,n as v,d as f,e as y,f as w,g as b,h as E,i as S,j as C,k as R,l as k,F as T,m as L,p as O,q as A,t as M,s as _,T as I,w as z,v as x,x as D,y as H,z as P,A as B,B as N,C as $,D as U,E as V,G as W,H as F}from"./vue-vendor-GQR5GLLq.js";function j(){const e=u(window.innerWidth),t=u(window.innerHeight),a=u(window.devicePixelRatio||1),n=u(0),r=p(()=>e.value>t.value),s=p(()=>e.value<375),i=p(()=>e.value>=375&&e.value<=414),o=p(()=>e.value>414),l=p(()=>a.value>=2),c=p(()=>n.value>0),m=p(()=>{const e=document.createElement("div");e.style.paddingTop="env(safe-area-inset-top)",document.body.appendChild(e);const t="0px"!==getComputedStyle(e).paddingTop;return document.body.removeChild(e),t}),g=p(()=>({screenWidth:e.value,screenHeight:t.value,pixelRatio:a.value,isLandscape:r.value,isSmallScreen:s.value,isMediumScreen:i.value,isLargeScreen:o.value,isHighDPI:l.value,hasNotch:m.value,keyboardHeight:n.value,isKeyboardOpen:c.value})),v=p(()=>({minSize:s.value?40:44,padding:s.value?8:12,margin:s.value?4:8})),f=p(()=>s.value?"14px":o.value?"18px":"16px"),y=p(()=>({xs:s.value?"2px":"4px",sm:s.value?"4px":"8px",md:s.value?"8px":"12px",lg:s.value?"12px":"16px",xl:s.value?"16px":"20px","2xl":s.value?"20px":"24px","3xl":s.value?"24px":"32px"})),w=()=>{e.value=window.innerWidth,t.value=window.innerHeight,a.value=window.devicePixelRatio||1},b=()=>{if(window.visualViewport){const e=window.visualViewport,t=e.height<.75*window.innerHeight;n.value=t?window.innerHeight-e.height:0}};return d(()=>{window.addEventListener("resize",w,{passive:!0}),window.addEventListener("orientationchange",w,{passive:!0}),window.visualViewport&&window.visualViewport.addEventListener("resize",b,{passive:!0}),w()}),h(()=>{window.removeEventListener("resize",w),window.removeEventListener("orientationchange",w),window.visualViewport&&window.visualViewport.removeEventListener("resize",b)}),{deviceInfo:g,touchAreaConfig:v,responsiveFontSize:f,responsiveSpacing:y,optimizeTouchTarget:e=>{const t=v.value,a=e.getBoundingClientRect();(a.width<t.minSize||a.height<t.minSize)&&(e.style.minWidth=`${t.minSize}px`,e.style.minHeight=`${t.minSize}px`,e.style.padding=`${t.padding}px`)},getOptimalImageSize:(e,t)=>{const a=l.value?2:1;return{width:Math.round(e*a),height:Math.round(t*a),scale:a}},supportsFeature:e=>{switch(e){case"touch":return"ontouchstart"in window;case"hover":return window.matchMedia("(hover: hover)").matches;case"pointer-fine":return window.matchMedia("(pointer: fine)").matches;case"reduced-motion":return window.matchMedia("(prefers-reduced-motion: reduce)").matches;case"dark-mode":return window.matchMedia("(prefers-color-scheme: dark)").matches;case"high-contrast":return window.matchMedia("(prefers-contrast: high)").matches;default:return!1}},screenWidth:e,screenHeight:t,isLandscape:r,isSmallScreen:s,isMediumScreen:i,isLargeScreen:o,isHighDPI:l,hasNotch:m,keyboardHeight:n,isKeyboardOpen:c}}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const J={},G=function(e,t,a){let n=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),r=(null==a?void 0:a.nonce)||(null==a?void 0:a.getAttribute("nonce"));n=e(t.map(e=>{if((e=function(e){return"/money-journey/"+e}(e))in J)return;J[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,r&&n.setAttribute("nonce",r),document.head.appendChild(n),t?new Promise((t,a)=>{n.addEventListener("load",t),n.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})};function q(){const e=u(60),t=u(0),a=u(0),n=u(0),r=p(()=>e.value<30||t.value>50);let s=0,i=performance.now(),o=null;const l=()=>{const t=performance.now();s++,t-i>=1e3&&(e.value=Math.round(1e3*s/(t-i)),s=0,i=t),o=requestAnimationFrame(l)},m=()=>{if("memory"in performance){const e=performance.memory;t.value=Math.round(e.usedJSHeapSize/e.jsHeapSizeLimit*100)}},g=(e,t)=>{let a=!1;return(...n)=>{a||(e(...n),a=!0,setTimeout(()=>a=!1,t))}},f=p(()=>({fps:e.value,memoryUsage:t.value,loadTime:a.value,renderTime:n.value,isLowPerformance:r.value}));return d(()=>{a.value=performance.now()}),h(()=>{o&&cancelAnimationFrame(o)}),{performanceMetrics:f,fps:e,memoryUsage:t,isLowPerformance:r,debounce:(e,t)=>{let a=null;return(...n)=>{a&&clearTimeout(a),a=setTimeout(()=>e(...n),t)}},throttle:g,createLazyLoader:(e={})=>{const{rootMargin:t="50px",threshold:a=.1,once:n=!0}=e,r=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target,a=t.dataset.src,s=t.dataset.srcset;a&&t instanceof HTMLImageElement&&(t.src=a,t.removeAttribute("data-src")),s&&t instanceof HTMLImageElement&&(t.srcset=s,t.removeAttribute("data-srcset")),t.dispatchEvent(new CustomEvent("lazy-loaded")),n&&r.unobserve(t)}})},{rootMargin:t,threshold:a});return{observe:e=>{r.observe(e)},unobserve:e=>{r.unobserve(e)},disconnect:()=>{r.disconnect()}}},createVirtualScroller:e=>{const{itemHeight:t,containerHeight:a,buffer:n=5,overscan:r=3}=e,s=u(0),i=u(0),o=p(()=>{const e=Math.floor(s.value/t),o=Math.min(e+Math.ceil(a/t),i.value);return{start:Math.max(0,e-n),end:Math.min(i.value,o+n+r)}}),l=p(()=>{const e=[];for(let a=o.value.start;a<o.value.end;a++)e.push({index:a,top:a*t,height:t});return e}),c=p(()=>i.value*t),d=g(e=>{const t=e.target;s.value=t.scrollTop},16);return{visibleRange:o,visibleItems:l,totalHeight:c,handleScroll:d,setTotalItems:e=>{i.value=e},scrollTop:s}},optimizeImage:(e,t,a,n=80)=>{const r=document.createElement("canvas"),s=r.getContext("2d"),i=new Image;return new Promise((o,l)=>{i.onload=()=>{if(r.width=t,r.height=a,s){s.drawImage(i,0,0,t,a);const e=r.toDataURL("image/jpeg",n/100);o(e)}else l(new Error("Canvas context not available"))},i.onerror=l,i.src=e})},preloadResource:(e,t="fetch")=>{const a=document.createElement("link");return a.rel="preload",a.href=e,a.as=t,document.head.appendChild(a),()=>{document.head.removeChild(a)}},loadChunk:e=>c(null,null,function*(){try{performance.now();const t=yield G(()=>import(`../chunks/${e}.js`),[]);performance.now();return t}catch(t){throw t}}),startPerformanceMonitoring:()=>{l();const e=setInterval(m,5e3);return()=>{o&&cancelAnimationFrame(o),clearInterval(e)}},measureRenderTime:e=>c(null,null,function*(){const t=performance.now();yield e(),yield v();const a=performance.now();return n.value=a-t,n.value})}}function K(){const{touchAreaConfig:e,supportsFeature:t}=j(),a=u(new Map),n=u(new Set),r=p(()=>"vibrate"in navigator),s=p(()=>t("touch")),i=p(()=>t("hover")),o=(e="medium")=>{if(!r.value)return;navigator.vibrate({light:[10],medium:[20],heavy:[30]}[e])},l=(e,t={})=>{const{duration:a=150}=t;e.style.transition=`transform ${a}ms ease, opacity ${a}ms ease`,e.style.transform="scale(0.95)",e.style.opacity="0.8",setTimeout(()=>{e.style.transform="",e.style.opacity=""},a)},c=t=>{const a=e.value,r=t.getBoundingClientRect();(r.width<a.minSize||r.height<a.minSize)&&(t.style.minWidth=`${a.minSize}px`,t.style.minHeight=`${a.minSize}px`);return(parseInt(getComputedStyle(t).padding)||0)<a.padding&&(t.style.padding=`${a.padding}px`),t.style.margin=`${a.margin}px`,t.style.cursor="pointer",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.webkitTapHighlightColor="transparent",n.value.add(t),{element:t,minSize:a.minSize,padding:a.padding,margin:a.margin}},d=(e,t,r={})=>{const{haptic:s=!0,visual:i=!0,duration:c=150}=r,u=n=>{var r;s&&o("light"),i&&l(e,{duration:c}),Array.from(n.touches).forEach(e=>{a.value.set(e.identifier,e)}),null==(r=t.onTouchStart)||r.call(t,n)},d=e=>{var n;Array.from(e.touches).forEach(e=>{a.value.set(e.identifier,e)}),null==(n=t.onTouchMove)||n.call(t,e)},h=e=>{var n;Array.from(e.changedTouches).forEach(e=>{a.value.delete(e.identifier)}),null==(n=t.onTouchEnd)||n.call(t,e)},m=e=>{var n;Array.from(e.changedTouches).forEach(e=>{a.value.delete(e.identifier)}),null==(n=t.onTouchCancel)||n.call(t,e)};return e.addEventListener("touchstart",u,{passive:!0}),e.addEventListener("touchmove",d,{passive:!0}),e.addEventListener("touchend",h,{passive:!0}),e.addEventListener("touchcancel",m,{passive:!0}),()=>{e.removeEventListener("touchstart",u),e.removeEventListener("touchmove",d),e.removeEventListener("touchend",h),e.removeEventListener("touchcancel",m),n.value.delete(e)}};return h(()=>{a.value.clear(),n.value.clear()}),{activeTouches:a,touchTargets:n,supportsHaptic:r,supportsTouch:s,supportsHover:i,hapticFeedback:o,visualFeedback:l,optimizeTouchTarget:c,addTouchHandlers:d,preventZoom:e=>{let t=0;const a=e=>{const a=Date.now();a-t<=300&&e.preventDefault(),t=a};return e.addEventListener("touchend",a,{passive:!1}),()=>{e.removeEventListener("touchend",a)}},optimizeScrolling:e=>(e.style.webkitOverflowScrolling="touch",e.style.overflowScrolling="touch",e.style.willChange="scroll-position",e.style.transform="translateZ(0)",()=>{e.style.webkitOverflowScrolling="",e.style.overflowScrolling="",e.style.willChange="",e.style.transform=""}),createTouchButton:(e,t,a={})=>{c(e);const n=d(e,{onTouchEnd:e=>{e.preventDefault(),t(e)}},a),r=e=>{s.value||t(e)};e.addEventListener("click",r);const i=e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t(e))};return e.addEventListener("keydown",i),e.hasAttribute("tabindex")||e.setAttribute("tabindex","0"),e.hasAttribute("role")||e.setAttribute("role","button"),()=>{n(),e.removeEventListener("click",r),e.removeEventListener("keydown",i)}},validateTouchTargets:()=>{const t=[];return n.value.forEach(a=>{var r;const s=a.getBoundingClientRect(),i=e.value;(s.width<i.minSize||s.height<i.minSize)&&t.push(`Touch target too small: ${s.width}x${s.height}px (minimum: ${i.minSize}px)`);Array.from((null==(r=a.parentElement)?void 0:r.children)||[]).filter(e=>e!==a&&n.value.has(e)).forEach(e=>{const a=e.getBoundingClientRect(),n=Math.min(Math.abs(s.right-a.left),Math.abs(s.left-a.right),Math.abs(s.bottom-a.top),Math.abs(s.top-a.bottom));n<i.margin&&t.push(`Touch targets too close: ${n}px spacing (minimum: ${i.margin}px)`)})}),t}}}var X=(e=>(e.STORAGE_ERROR="STORAGE_ERROR",e.VALIDATION_ERROR="VALIDATION_ERROR",e.CALCULATION_ERROR="CALCULATION_ERROR",e.NETWORK_ERROR="NETWORK_ERROR",e.COMPONENT_ERROR="COMPONENT_ERROR",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e))(X||{}),Y=(e=>(e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e))(Y||{}),Z=(e=>(e.SUCCESS="success",e.ERROR="error",e.WARNING="warning",e.INFO="info",e))(Z||{});function Q(e=""){const t=Date.now().toString(36),a=Math.random().toString(36).substring(2,8);return e?`${e}-${t}-${a}`:`${t}-${a}`}function ee(){const e=u([]),t=t=>{const{type:n,title:s,message:i,duration:o=r(n),persistent:l=!1,actions:c}=t,u={id:Q(),type:n,title:s,message:i,duration:o,persistent:l,actions:c,timestamp:new Date};if(e.value.push(u),e.value.length>5){e.value.splice(0,e.value.length-5).forEach(e=>clearTimeout(e.id))}return!l&&o>0&&setTimeout(()=>{a(u.id)},o),u.id},a=t=>{const a=e.value.findIndex(e=>e.id===t);a>=0&&e.value.splice(a,1)},n=(t,a)=>{const n=e.value.findIndex(e=>e.id===t);n>=0&&(e.value[n]=o(o({},e.value[n]),a))},r=e=>{switch(e){case Z.SUCCESS:return 3e3;case Z.INFO:return 4e3;case Z.WARNING:return 5e3;case Z.ERROR:return 6e3;default:return 4e3}};return{toasts:m(e),showToast:t,showSuccess:(e,a,n)=>t({type:Z.SUCCESS,title:a,message:e,duration:n}),showError:(e,a,n)=>t({type:Z.ERROR,title:a,message:e,persistent:null==n?void 0:n.persistent,actions:null==n?void 0:n.actions}),showWarning:(e,a,n)=>t({type:Z.WARNING,title:a,message:e,duration:n}),showInfo:(e,a,n)=>t({type:Z.INFO,title:a,message:e,duration:n}),removeToast:a,clearAllToasts:()=>{e.value=[]},clearToastsByType:t=>{e.value=e.value.filter(e=>e.type!==t)},updateToast:n,showLoadingToast:(e="加载中...")=>t({type:Z.INFO,message:e,persistent:!0}),updateLoadingToast:(e,t)=>{n(e,{message:t})},hideLoadingToast:(e,t)=>{t?(n(e,{type:Z.SUCCESS,message:t,persistent:!1,duration:2e3}),setTimeout(()=>a(e),2e3)):a(e)},getToastIcon:e=>{switch(e){case Z.SUCCESS:return"✓";case Z.ERROR:return"✕";case Z.WARNING:return"⚠";case Z.INFO:return"ℹ";default:return""}},getToastColor:e=>{switch(e){case Z.SUCCESS:return"#34C759";case Z.ERROR:return"#FF3B30";case Z.WARNING:return"#FF9500";case Z.INFO:return"#007AFF";default:return"#8E8E93"}},hasToasts:()=>e.value.length>0,getToastCount:()=>e.value.length,getToastsByType:t=>e.value.filter(e=>e.type===t),hasErrorToasts:()=>e.value.some(e=>e.type===Z.ERROR),hasPersistentToasts:()=>e.value.some(e=>e.persistent)}}let te=null;function ae(){return te||(te=function(){const{showLoadingToast:e,hideLoadingToast:t}=ee(),a=u(new Map),n=u(!1),r=u(),s=u(),i=p(()=>n.value||a.value.size>0),d=p(()=>{var e;return r.value||(null==(e=Array.from(a.value.values())[0])?void 0:e.message)}),h=p(()=>{if(void 0!==s.value)return s.value;const e=Array.from(a.value.values()).filter(e=>void 0!==e.progress);return 0!==e.length?e.reduce((e,t)=>e+(t.progress||0),0)/e.length:void 0}),m=p(()=>Array.from(a.value.values()).some(e=>e.cancelable)),g=(n,r={})=>{const{message:s="加载中...",timeout:i,showProgress:c=!1,cancelable:u=!1,onTimeout:d,onCancel:h}=r,m={isLoading:!0,message:s,progress:c?0:void 0,cancelable:u,onCancel:h};let g,p;if(a.value.set(n,m),i&&i>0&&(g=setTimeout(()=>{v(n),d&&d()},i)),i&&i>3e3&&(p=e(s)),g||p){const e=a.value.get(n);e&&a.value.set(n,l(o({},e),{onCancel:()=>{g&&clearTimeout(g),p&&t(p),h&&h()}}))}return n},v=(e,t)=>{const n=a.value.get(e);n&&(n.onCancel&&n.onCancel(),a.value.delete(e))},f=(e,t,n)=>{const r=a.value.get(e);r&&a.value.set(e,l(o({},r),{progress:Math.max(0,Math.min(100,t)),message:n||r.message}))},y=e=>{const t=a.value.get(e);t&&t.cancelable&&t.onCancel&&t.onCancel(),v(e)},w=(e,t,a)=>{n.value=e,r.value=t,s.value=a},b=e=>{w(!0,e)},E=()=>{w(!1)};return{isLoading:i,loadingMessage:d,loadingProgress:h,canCancel:m,startLoading:g,stopLoading:v,updateProgress:f,updateMessage:(e,t)=>{const n=a.value.get(e);n&&a.value.set(e,l(o({},n),{message:t}))},cancelLoading:y,cancelAllLoading:()=>{Array.from(a.value.keys()).forEach(e=>y(e)),w(!1)},setGlobalLoading:w,startGlobalLoading:b,stopGlobalLoading:E,updateGlobalProgress:(e,t)=>{n.value&&(s.value=Math.max(0,Math.min(100,e)),t&&(r.value=t))},isLoadingKey:e=>a.value.has(e),getLoadingState:e=>a.value.get(e),getAllLoadingKeys:()=>Array.from(a.value.keys()),getLoadingCount:()=>a.value.size+(n.value?1:0),clearAllLoading:()=>{a.value.clear(),w(!1)},withLoading:(e,t,...a)=>c(null,[e,t,...a],function*(e,t,a={}){g(e,a);try{const a=yield t();return v(e),a}catch(n){throw v(e),n}}),withGlobalLoading:(e,t)=>c(null,null,function*(){b(t);try{const t=yield e();return E(),t}catch(a){throw E(),a}}),startBatchLoading:e=>{e.forEach(({key:e,options:t})=>{g(e,t)})},stopBatchLoading:e=>{e.forEach(e=>v(e))},updateBatchProgress:e=>{e.forEach(({key:e,progress:t,message:a})=>{f(e,t,a)})}}}()),te}const ne=[{name:"餐饮",icon:"🍽️",color:"#FF6B6B",isDefault:!0},{name:"交通",icon:"🚗",color:"#4ECDC4",isDefault:!0},{name:"购物",icon:"🛍️",color:"#45B7D1",isDefault:!0},{name:"娱乐",icon:"🎬",color:"#96CEB4",isDefault:!0},{name:"医疗",icon:"🏥",color:"#FFEAA7",isDefault:!0},{name:"教育",icon:"📚",color:"#DDA0DD",isDefault:!0},{name:"其他",icon:"📝",color:"#95A5A6",isDefault:!0}];function re(){const{showToast:e}=ee(),t=u([]),a=u(!1),n=(e,t,a={})=>{const{severity:n=Y.MEDIUM,details:r,context:s,component:i,action:o,recoverable:l=!0,originalError:c}=a;return{id:Q(),type:e,severity:n,message:t,details:r,context:s,timestamp:new Date,stack:null==c?void 0:c.stack,component:i,action:o,recoverable:l}},r=(a,...r)=>c(null,[a,...r],function*(a,r={}){const{showToast:i=!0,logToConsole:c=!0,reportToService:u=!1,attemptRecovery:d=!0,fallbackAction:h}=r;let m;if(m="string"==typeof a?n(X.UNKNOWN_ERROR,a):a instanceof Error?n(X.UNKNOWN_ERROR,a.message,{originalError:a,details:a.stack}):a,t.value.push(m),c&&m.stack,i&&e({type:"error",title:o(m.type),message:m.message,duration:m.severity===Y.CRITICAL?0:5e3,persistent:m.severity===Y.CRITICAL,actions:m.recoverable?[{label:"重试",action:()=>s(m)}]:void 0}),d&&m.recoverable&&(yield s(m)),h)try{h()}catch(g){}u&&(yield l(m))}),s=n=>c(null,null,function*(){if(a.value)return{success:!1,message:"正在进行恢复操作，请稍候"};a.value=!0;try{const a=i(n);for(const s of a)if(s.automatic){if(yield s.action()){const a=t.value.findIndex(e=>e.id===n.id);return a>=0&&t.value.splice(a,1),e({type:"success",message:`恢复成功: ${s.description}`,duration:3e3}),{success:!0,message:s.description}}}const r=a.filter(e=>!e.automatic);return r.length>0?{success:!1,message:"自动恢复失败，请选择手动恢复选项",actions:r}:{success:!1,message:"无法自动恢复，请刷新页面或联系支持"}}catch(r){return{success:!1,message:"恢复操作失败"}}finally{a.value=!1}}),i=e=>{const t=[];switch(e.type){case X.STORAGE_ERROR:t.push({id:"retry-save",label:"重试保存",description:"重新尝试保存数据",action:()=>c(null,null,function*(){return!0}),priority:1,automatic:!0},{id:"clear-cache",label:"清理缓存",description:"清理本地缓存数据",action:()=>c(null,null,function*(){return!0}),priority:2,automatic:!1});break;case X.CALCULATION_ERROR:t.push({id:"recalculate",label:"重新计算",description:"重新执行预算计算",action:()=>c(null,null,function*(){return!0}),priority:1,automatic:!0},{id:"reset-budget",label:"重置预算",description:"重置预算到安全状态",action:()=>c(null,null,function*(){return!0}),priority:2,automatic:!1});break;case X.COMPONENT_ERROR:t.push({id:"refresh-component",label:"刷新组件",description:"重新加载组件",action:()=>c(null,null,function*(){return!0}),priority:1,automatic:!0});break;default:t.push({id:"generic-retry",label:"重试操作",description:"重新尝试上次操作",action:()=>c(null,null,function*(){return!0}),priority:1,automatic:!0})}return t.sort((e,t)=>e.priority-t.priority)},o=e=>{switch(e){case X.STORAGE_ERROR:return"存储错误";case X.VALIDATION_ERROR:return"输入错误";case X.CALCULATION_ERROR:return"计算错误";case X.NETWORK_ERROR:return"网络错误";case X.COMPONENT_ERROR:return"组件错误";default:return"系统错误"}},l=e=>c(null,null,function*(){});return{errors:m(t),isRecovering:m(a),handleError:r,handleStorageError:(e,t)=>c(null,null,function*(){const a=n(X.STORAGE_ERROR,"数据保存失败，请检查存储空间",{severity:Y.HIGH,details:e.message,context:t,originalError:e,recoverable:!0});yield r(a,{attemptRecovery:!0,fallbackAction:()=>{}})}),handleValidationError:(e,t,a)=>{const s=n(X.VALIDATION_ERROR,t,{severity:Y.LOW,context:{field:e,value:a},recoverable:!0});r(s,{showToast:!1,logToConsole:!1})},handleCalculationError:(e,t)=>c(null,null,function*(){const a=n(X.CALCULATION_ERROR,"预算计算出现问题，请重试",{severity:Y.MEDIUM,details:e.message,context:t,originalError:e,recoverable:!0});yield r(a,{attemptRecovery:!0,fallbackAction:()=>{}})}),handleComponentError:(e,t,a)=>c(null,null,function*(){const s=n(X.COMPONENT_ERROR,`组件 ${e} 发生错误`,{severity:Y.MEDIUM,details:t.message,context:a,component:e,originalError:t,recoverable:!0});yield r(s)}),attemptErrorRecovery:s,createError:n,clearError:e=>{const a=t.value.findIndex(t=>t.id===e);a>=0&&t.value.splice(a,1)},clearAllErrors:()=>{t.value=[]},getErrorsByType:e=>t.value.filter(t=>t.type===e),getErrorsBySeverity:e=>t.value.filter(t=>t.severity===e),hasErrors:()=>t.value.length>0,hasCriticalErrors:()=>t.value.some(e=>e.severity===Y.CRITICAL)}}let se=null;let ie=null;function oe(){return ie||(ie=function(){const{handleError:e}=re(),{showSuccess:t,showError:a}=ee(),n=u(!1),r=u(!1),s=u(null),i=u([]),d="backup_",h="recovery_log",g="auto_backup_",p=(n,i)=>c(null,null,function*(){r.value=!0;try{const e=Q(),a=new Date,r={id:e,label:i||`备份 ${a.toLocaleString()}`,data:n,timestamp:a.toISOString(),version:"1.0.0",size:JSON.stringify(n).length,checksum:C(n)},o=`${d}${e}`;return localStorage.setItem(o,JSON.stringify(r)),s.value=a,t("数据备份成功"),e}catch(o){const t="创建备份失败";throw a(t),yield e(o,{context:{operation:"createBackup"}}),new Error(t)}finally{r.value=!1}}),v=()=>{const e=[];try{for(let a=0;a<localStorage.length;a++){const n=localStorage.key(a);if(null==n?void 0:n.startsWith(d))try{const t=JSON.parse(localStorage.getItem(n)||"{}");e.push({id:t.id,label:t.label,timestamp:new Date(t.timestamp),size:t.size||0,automatic:!1})}catch(t){}}for(let a=0;a<localStorage.length;a++){const n=localStorage.key(a);if(null==n?void 0:n.startsWith(g))try{const t=JSON.parse(localStorage.getItem(n)||"{}");e.push({id:n,label:`自动备份 ${new Date(t.timestamp).toLocaleDateString()}`,timestamp:new Date(t.timestamp),size:JSON.stringify(t.data).length,automatic:!0})}catch(t){}}return e.sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime())}catch(t){return[]}},f=e=>c(null,null,function*(){n.value=!0;try{const a=e.startsWith(d)||e.startsWith(g)?e:`${d}${e}`,n=localStorage.getItem(a);if(!n)throw new Error("备份文件不存在");const r=JSON.parse(n),s=r.data||r,i=y(s);if(!i.isValid)throw new Error(`备份数据无效: ${i.errors.join(", ")}`);const o=b();yield p(o,"恢复前自动备份"),yield E(s);const l={success:!0,message:"数据恢复成功"};return k(l),t("数据已成功恢复"),l}catch(r){const e={success:!1,message:r instanceof Error?r.message:"数据恢复失败"};return k(e),a(e.message),e}finally{n.value=!1}}),y=e=>{const t=[];return e&&"object"==typeof e?(e.budgets&&!Array.isArray(e.budgets)&&t.push("预算数据格式无效"),e.expenses&&!Array.isArray(e.expenses)&&t.push("消费记录数据格式无效"),e.categories&&!Array.isArray(e.categories)&&t.push("分类数据格式无效"),{isValid:0===t.length,errors:t}):(t.push("备份数据格式无效"),{isValid:!1,errors:t})},w=e=>c(null,null,function*(){try{const t={budgets:[],expenses:[],categories:[],lastUpdated:new Date,version:"1.0.0"};return Array.isArray(e.budgets)&&(t.budgets=e.budgets.filter(e=>e&&"string"==typeof e.id&&"number"==typeof e.monthlyAmount&&e.monthlyAmount>0).map(e=>l(o({},e),{startDate:new Date(e.startDate),endDate:new Date(e.endDate),createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),dailyAllocation:e.dailyAllocation||[]}))),Array.isArray(e.expenses)&&(t.expenses=e.expenses.filter(e=>e&&"string"==typeof e.id&&"number"==typeof e.amount&&e.amount>0).map(e=>l(o({},e),{date:new Date(e.date),createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}))),Array.isArray(e.categories)&&(t.categories=e.categories.filter(e=>e&&"string"==typeof e.id&&"string"==typeof e.name)),0===t.categories.length&&(t.categories=ne.map(e=>l(o({},e),{id:Q()}))),t}catch(t){return null}}),b=()=>{try{return{budgets:JSON.parse(localStorage.getItem("budgets")||"[]"),expenses:JSON.parse(localStorage.getItem("expenses")||"[]"),categories:JSON.parse(localStorage.getItem("categories")||"[]"),lastUpdated:new Date,version:"1.0.0"}}catch(e){return{budgets:[],expenses:[],categories:[],lastUpdated:new Date,version:"1.0.0"}}},E=e=>c(null,null,function*(){localStorage.setItem("budgets",JSON.stringify(e.budgets)),localStorage.setItem("expenses",JSON.stringify(e.expenses)),localStorage.setItem("categories",JSON.stringify(e.categories))}),S=()=>c(null,null,function*(){const e={budgets:[],expenses:[],categories:ne.map(e=>l(o({},e),{id:Q()}))};yield E(e)}),C=e=>{const t=JSON.stringify(e);let a=0;for(let n=0;n<t.length;n++)a=(a<<5)-a+t.charCodeAt(n),a&=a;return a.toString(16)},R=()=>c(null,null,function*(){try{const t=new Date;t.setDate(t.getDate()-30);const a=[];for(let n=0;n<localStorage.length;n++){const r=localStorage.key(n);if(null==r?void 0:r.startsWith(g))try{const e=JSON.parse(localStorage.getItem(r)||"{}");new Date(e.timestamp)<t&&a.push(r)}catch(e){a.push(r)}}a.forEach(e=>localStorage.removeItem(e)),a.length}catch(e){}}),k=e=>{try{const t=[...i.value,e];t.length>10&&t.splice(0,t.length-10),i.value=t,localStorage.setItem(h,JSON.stringify(t))}catch(t){}};return(()=>{try{const e=localStorage.getItem(h);e&&(i.value=JSON.parse(e))}catch(e){i.value=[]}})(),{isRecovering:m(n),isBackingUp:m(r),lastBackupDate:m(s),recoveryHistory:m(i),createBackup:p,createAutoBackup:e=>c(null,null,function*(){try{const t=new Date,a=`${g}${t.toISOString().split("T")[0]}`,n={data:e,timestamp:t.toISOString(),automatic:!0};localStorage.setItem(a,JSON.stringify(n)),yield R()}catch(t){}}),getAvailableBackups:v,deleteBackup:e=>c(null,null,function*(){try{const a=e.startsWith(d)?e:`${d}${e}`;localStorage.removeItem(a),t("备份已删除")}catch(n){throw a("删除备份失败"),n}}),restoreFromBackup:f,attemptAutoRecovery:()=>c(null,null,function*(){n.value=!0;try{const e=v().filter(e=>e.automatic);if(e.length>0){const t=e[0];return yield f(t.id)}const a=v().filter(e=>!e.automatic);if(a.length>0){const e=a[0];return yield f(e.id)}yield S();const n={success:!0,message:"已初始化默认数据"};return k(n),t("已恢复到初始状态"),n}catch(e){const t={success:!1,message:"自动恢复失败"};return k(t),t}finally{n.value=!1}}),repairCorruptedData:()=>c(null,null,function*(){try{const e=b(),a=yield w(e);if(a){yield E(a);const e={success:!0,message:"数据修复成功"};return k(e),t("数据已修复"),e}throw new Error("无法修复数据")}catch(e){const t={success:!1,message:"数据修复失败"};return k(t),t}}),validateBackupData:y,getCurrentData:b,initializeDefaultData:S,cleanupOldAutoBackups:R,exportData:()=>{const e=b();return JSON.stringify(e,null,2)},importData:e=>c(null,null,function*(){try{const a=JSON.parse(e),n=y(a);if(!n.isValid)throw new Error(`导入数据无效: ${n.errors.join(", ")}`);const r=b();yield p(r,"导入前自动备份"),yield E(a);const s={success:!0,message:"数据导入成功"};return k(s),t("数据已成功导入"),s}catch(n){const e={success:!1,message:n instanceof Error?n.message:"数据导入失败"};return k(e),a(e.message),e}})}}()),ie}const le={class:"safe-area-content"},ce=(e,t)=>{const a=e.__vccOpts||e;for(const[n,r]of t)a[n]=r;return a},ue=ce(f({__name:"SafeArea",props:{showTabBar:{type:Boolean,default:!0},adaptToKeyboard:{type:Boolean,default:!0},minHeight:{default:"100vh"}},setup(e){R(e=>({"453e2b7f":t.minHeight}));const t=e,a=u(window.innerWidth),n=u(window.innerHeight),r=u(window.innerWidth>window.innerHeight),s=u(0),i=p(()=>a.value<375),o=p(()=>a.value>414),l=p(()=>{const e={};return t.adaptToKeyboard&&s.value>0&&(e.paddingBottom=`${s.value}px`),r.value&&(e.paddingTop="max(env(safe-area-inset-top), 8px)",e.paddingBottom="max(env(safe-area-inset-bottom), 8px)"),e}),c=()=>{a.value=window.innerWidth,n.value=window.innerHeight,r.value=window.innerWidth>window.innerHeight},m=()=>{if(window.visualViewport){const e=window.visualViewport,t=e.height<.75*window.innerHeight;s.value=t?window.innerHeight-e.height:0}};return d(()=>{window.addEventListener("resize",c,{passive:!0}),window.addEventListener("orientationchange",c,{passive:!0}),window.visualViewport&&window.visualViewport.addEventListener("resize",m,{passive:!0}),c()}),h(()=>{window.removeEventListener("resize",c),window.removeEventListener("orientationchange",c),window.visualViewport&&window.visualViewport.removeEventListener("resize",m)}),(e,t)=>(w(),y("div",{class:E(["safe-area",{"with-tab-bar":e.showTabBar,"is-landscape":r.value,"is-small-screen":i.value,"is-large-screen":o.value}]),style:b(l.value)},[S("div",le,[C(e.$slots,"default",{},void 0)])],6))}}),[["__scopeId","data-v-7268cf17"]]),de={class:"tab-bar"},he={class:"tab-bar-content"},me=["onClick"],ge={class:"tab-icon"},pe={class:"tab-label"},ve=f({__name:"TabBar",setup(e){const t=[{name:"Dashboard",label:"概览",icon:{template:'\n    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" fill="currentColor"/>\n    </svg>\n  '}},{name:"ExpenseRecord",label:"记录",icon:{template:'\n    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>\n    </svg>\n  '}},{name:"ExpenseHistory",label:"历史",icon:{template:'\n    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3M12,8V13L16.28,15.54L17.5,13.33L14.5,11.5V8H12Z" fill="currentColor"/>\n    </svg>\n  '}},{name:"Statistics",label:"统计",icon:{template:'\n    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6h-6z" fill="currentColor"/>\n    </svg>\n  '}},{name:"BudgetSettings",label:"设置",icon:{template:'\n    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z" fill="currentColor"/>\n    </svg>\n  '}}],a=g(),n=k(),r=p(()=>n.name);return(e,n)=>(w(),y("div",de,[n[0]||(n[0]=S("div",{class:"tab-bar-background"},null,-1)),S("div",he,[(w(),y(T,null,L(t,e=>S("button",{key:e.name,class:E(["tab-item",{active:r.value===e.name}]),onClick:t=>{return n=e.name,void(r.value!==n&&a.push({name:n}));var n}},[S("div",ge,[(w(),O(A(e.icon)))]),S("span",pe,M(e.label),1)],10,me)),64))])]))}}),fe=ce(ve,[["__scopeId","data-v-a169e266"]]),ye={class:"toast-container"},we=["onClick"],be={class:"toast__content"},Ee={class:"toast__icon"},Se={class:"toast__text"},Ce={key:0,class:"toast__title"},Re={class:"toast__message"},ke=["onClick"],Te={key:0,class:"toast__actions"},Le=["onClick"],Oe=ce(f({__name:"Toast",setup(e){const{toasts:t,removeToast:a,getToastIcon:n}=ee();return(e,r)=>(w(),O(x,{to:"body"},[S("div",ye,[_(I,{name:"toast",tag:"div",class:"toast-list"},{default:z(()=>[(w(!0),y(T,null,L(D(t),e=>(w(),y("div",{key:e.id,class:E(["toast",`toast--${e.type}`,{"toast--persistent":e.persistent}]),onClick:t=>(e=>{var t;e.persistent||(null==(t=e.actions)?void 0:t.length)||a(e.id)})(e)},[S("div",be,[S("div",Ee,M(D(n)(e.type)),1),S("div",Se,[e.title?(w(),y("div",Ce,M(e.title),1)):H("",!0),S("div",Re,M(e.message),1)]),e.persistent||e.actions?(w(),y("button",{key:0,class:"toast__close",onClick:P(t=>D(a)(e.id),["stop"]),"aria-label":"关闭"}," ✕ ",8,ke)):H("",!0)]),e.actions&&e.actions.length>0?(w(),y("div",Te,[(w(!0),y(T,null,L(e.actions,t=>(w(),y("button",{key:t.label,class:E(["toast__action",`toast__action--${t.style||"secondary"}`]),onClick:P(n=>((e,t)=>{try{e.action(),t.persistent||a(t.id)}catch(n){}})(t,e),["stop"])},M(t.label),11,Le))),128))])):H("",!0)],10,we))),128))]),_:1})])]))}}),[["__scopeId","data-v-7f7e00e0"]]),Ae={class:"loading-content"},Me={key:0,class:"loading-message"},_e={key:1,class:"loading-progress"},Ie={class:"progress-bar"},ze={class:"progress-text"},xe=ce(f({__name:"LoadingSpinner",props:{visible:{type:Boolean,default:!1},global:{type:Boolean,default:!1},message:{},progress:{},showProgress:{type:Boolean,default:!1},cancelable:{type:Boolean,default:!1}},emits:["cancel","backdropClick"],setup(e,{emit:t}){const a=e,n=t,r=p(()=>a.visible),s=()=>{a.cancelable&&n("cancel")},i=()=>{n("backdropClick"),a.cancelable&&s()};return(e,t)=>r.value?(w(),y("div",{key:0,class:E(["loading-overlay",{"loading-overlay--global":e.global,"loading-overlay--inline":!e.global,"loading-overlay--cancelable":e.cancelable}])},[S("div",{class:"loading-overlay__backdrop",onClick:i}),S("div",Ae,[t[0]||(t[0]=S("div",{class:"loading-spinner"},[S("div",{class:"spinner-ring"},[S("div",{class:"spinner-ring__circle"})])],-1)),e.message?(w(),y("div",Me,M(e.message),1)):H("",!0),e.showProgress&&void 0!==e.progress?(w(),y("div",_e,[S("div",Ie,[S("div",{class:"progress-bar__fill",style:b({width:`${Math.max(0,Math.min(100,e.progress))}%`})},null,4)]),S("div",ze,M(Math.round(e.progress))+"% ",1)])):H("",!0),e.cancelable?(w(),y("button",{key:2,class:"loading-cancel",onClick:s}," 取消 ")):H("",!0)])],2)):H("",!0)}}),[["__scopeId","data-v-6e222e81"]]),De={class:"performance-monitor-header"},He={key:0,class:"performance-monitor-content"},Pe={class:"performance-metric"},Be={class:"performance-metric"},Ne={class:"performance-metric"},$e={class:"metric-value"},Ue={class:"performance-metric"},Ve={class:"metric-value"},We={class:"performance-metric"},Fe={class:"metric-value"},je={key:0,class:"performance-issues"},Je={class:"issues-list"},Ge=ce(f({__name:"PerformanceMonitor",props:{showMonitor:{type:Boolean,default:!0}},setup(e){const t=e,{performanceMetrics:a,startPerformanceMonitoring:n}=q(),{deviceInfo:r}=j(),{touchTargets:s,validateTouchTargets:i}=K(),o=u(!1),l=u([]),c=p(()=>!1),h=p(()=>a.value.fps),m=p(()=>a.value.memoryUsage),g=p(()=>a.value.renderTime),v=p(()=>a.value.isLowPerformance),f=p(()=>s.value.size),b=()=>{o.value=!o.value},C=()=>{l.value=i()};return d(()=>{c.value&&t.showMonitor&&(n(),setTimeout(()=>{C()},1e3))}),(e,t)=>e.showMonitor&&c.value?(w(),y("div",{key:0,class:E(["performance-monitor",{"performance-monitor--warning":v.value}])},[S("div",De,[t[0]||(t[0]=S("span",{class:"performance-monitor-title"},"性能监控",-1)),S("button",{class:"performance-monitor-toggle",onClick:b},M(o.value?"−":"+"),1)]),o.value?(w(),y("div",He,[S("div",Pe,[t[1]||(t[1]=S("span",{class:"metric-label"},"FPS:",-1)),S("span",{class:E(["metric-value",{"metric-value--warning":h.value<30}])},M(h.value),3)]),S("div",Be,[t[2]||(t[2]=S("span",{class:"metric-label"},"内存:",-1)),S("span",{class:E(["metric-value",{"metric-value--warning":m.value>50}])},M(m.value)+"% ",3)]),S("div",Ne,[t[3]||(t[3]=S("span",{class:"metric-label"},"渲染:",-1)),S("span",$e,M(g.value.toFixed(1))+"ms",1)]),S("div",Ue,[t[4]||(t[4]=S("span",{class:"metric-label"},"设备:",-1)),S("span",Ve,M(D(r).screenWidth)+"×"+M(D(r).screenHeight)+" "+M(D(r).isHighDPI?"@2x":""),1)]),S("div",We,[t[5]||(t[5]=S("span",{class:"metric-label"},"触摸目标:",-1)),S("span",Fe,M(f.value),1),S("button",{class:"metric-action",onClick:C}," 验证 ")]),l.value.length>0?(w(),y("div",je,[t[6]||(t[6]=S("div",{class:"issues-title"},"触摸目标问题:",-1)),S("ul",Je,[(w(!0),y(T,null,L(l.value,e=>(w(),y("li",{key:e,class:"issue-item"},M(e),1))),128))])])):H("",!0)])):H("",!0)],2)):H("",!0)}}),[["__scopeId","data-v-1b5a0af0"]]),qe={id:"app"},Ke=f({__name:"App",setup(e){const t=k(),a=g(),{isLoading:n,loadingMessage:r,loadingProgress:s,canCancel:i,cancelAllLoading:o}=ae(),{createAutoBackup:l,getCurrentData:v}=oe();j();const{startPerformanceMonitoring:f}=q();K();const{onSwipe:b}=function(e={}){const t=g(),{enableSwipeBack:a=!0,swipeThreshold:n=50,edgeThreshold:r=20}=e,s=u(!1),i=u(0),o=u(0),l=u(0),c=u(0),p=u(0),v=u([]),f=e=>{const t=e.touches[0];i.value=t.clientX,o.value=t.clientY,c.value=t.clientX,p.value=t.clientY,l.value=Date.now(),s.value=!0},y=e=>{if(!s.value)return;const t=e.touches[0];c.value=t.clientX,p.value=t.clientY},w=e=>{if(!s.value)return;const c=e.changedTouches[0],u=c.clientX,d=c.clientY,h=Date.now(),m=u-i.value,g=d-o.value,p=h-l.value,f=Math.sqrt(m*m+g*g),y=f/p;let w;w=Math.abs(m)>Math.abs(g)?m>0?"right":"left":g>0?"down":"up";const b={direction:w,distance:f,velocity:y,startX:i.value,startY:o.value,endX:u,endY:d};a&&"right"===w&&i.value<r&&Math.abs(m)>n&&Math.abs(m)>Math.abs(g)&&t.options.history.state.position>0&&t.back(),v.value.forEach(e=>e(b)),s.value=!1},b=()=>{s.value=!1};return d(()=>{document.addEventListener("touchstart",f,{passive:!0}),document.addEventListener("touchmove",y,{passive:!0}),document.addEventListener("touchend",w,{passive:!0}),document.addEventListener("touchcancel",b,{passive:!0})}),h(()=>{document.removeEventListener("touchstart",f),document.removeEventListener("touchmove",y),document.removeEventListener("touchend",w),document.removeEventListener("touchcancel",b)}),{isTracking:m(s),onSwipe:e=>(v.value.push(e),()=>{const t=v.value.indexOf(e);t>-1&&v.value.splice(t,1)})}}({enableSwipeBack:!0,swipeThreshold:50,edgeThreshold:20}),E=u(!1),S=u("slide-right"),C=p(()=>{var e;return!1!==(null==(e=t.meta)?void 0:e.showTabBar)});B(t,(e,t)=>{const a=["Dashboard","ExpenseRecord","Statistics","BudgetSettings"],n=a.indexOf(t.name),r=a.indexOf(e.name);S.value=-1!==n&&-1!==r&&r>n?"slide-left":"slide-right"}),a.beforeEach((e,t)=>{const n=a.options.history.state;n&&n.position<n.forward?(E.value=!0,S.value="slide-right"):E.value=!1}),b(e=>{});const R=e=>{},T=e=>{};d(()=>c(null,null,function*(){const e=f();try{const e=v();(e.budgets.length>0||e.expenses.length>0)&&(yield l(e))}catch(t){}return()=>{e()}}));let L=null;return B(t,()=>{L&&clearTimeout(L),L=setTimeout(()=>c(null,null,function*(){try{const e=v();yield l(e)}catch(e){}}),5e3)}),(e,t)=>{const a=N("router-view");return w(),y("div",qe,[_(ue,{"show-tab-bar":C.value},{default:z(()=>[_(a,null,{default:z(({Component:e,route:t})=>[_($,{name:S.value,mode:"out-in",onEnter:R,onLeave:T},{default:z(()=>[(w(),O(A(e),{key:t.path}))]),_:2},1032,["name"])]),_:1})]),_:1},8,["show-tab-bar"]),C.value?(w(),O(fe,{key:0})):H("",!0),_(Oe),_(xe,{visible:D(n),global:!0,message:D(r),progress:D(s),"show-progress":void 0!==D(s),cancelable:D(i),onCancel:D(o)},null,8,["visible","message","progress","show-progress","cancelable","onCancel"]),_(Ge)])}}}),Xe=U({history:V("/money-journey/"),routes:[{path:"/",name:"Dashboard",component:()=>G(()=>import("./Dashboard-CnUWrhp4.js"),__vite__mapDeps([0,1,2,3,4,5])),meta:{title:"预算概览",showTabBar:!0,transition:"slide-left"}},{path:"/budget-settings",name:"BudgetSettings",component:()=>G(()=>import("./BudgetSettings-a7DAA22w.js"),__vite__mapDeps([6,1,7,8,2,3,9])),meta:{title:"预算设置",showTabBar:!0,transition:"slide-left"}},{path:"/expense-record",name:"ExpenseRecord",component:()=>G(()=>import("./ExpenseRecord-AQTDNhG_.js"),__vite__mapDeps([10,1,4,3,7,8,11])),meta:{title:"记录消费",showTabBar:!0,transition:"slide-left"}},{path:"/statistics",name:"Statistics",component:()=>G(()=>import("./Statistics-Df3oNLDc.js"),__vite__mapDeps([12,1,4,3,2,13])),meta:{title:"统计分析",showTabBar:!0,transition:"slide-left"}},{path:"/expense-history",name:"ExpenseHistory",component:()=>G(()=>import("./ExpenseHistory-BG0RMa_4.js"),__vite__mapDeps([14,1,4,3,15])),meta:{title:"消费历史",showTabBar:!0,transition:"slide-left"}},{path:"/home",redirect:"/"}]});var Ye=Object.defineProperty,Ze=(e,t,a)=>((e,t,a)=>t in e?Ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);const Qe=new class{constructor(){Ze(this,"metrics",{}),Ze(this,"optimizations",new Map)}initialize(){this.setupPerformanceObserver(),this.applyOptimizations(),this.scheduleMetricsCollection()}applyOptimizations(){const e=[],t=[];return this.applyImageLazyLoading()?e.push("Image lazy loading"):t.push("Image lazy loading"),this.prefetchCriticalResources()?e.push("Resource prefetching"):t.push("Resource prefetching"),this.enablePassiveEventListeners()?e.push("Passive event listeners"):t.push("Passive event listeners"),this.optimizeScrollPerformance()?e.push("Scroll optimization"):t.push("Scroll optimization"),this.enableMemoryCleanup()?e.push("Memory cleanup"):t.push("Memory cleanup"),{applied:e,skipped:t,metrics:this.getCurrentMetrics()}}setupPerformanceObserver(){if("PerformanceObserver"in window)try{new PerformanceObserver(e=>{e.getEntries().forEach(e=>{if("navigation"===e.entryType){const t=e;this.metrics.loadTime=t.loadEventEnd-t.fetchStart,this.metrics.renderTime=t.domContentLoadedEventEnd-t.domContentLoadedEventStart}})}).observe({entryTypes:["navigation"]});new PerformanceObserver(e=>{const t=e.getEntries();this.analyzeResourceTiming(t)}).observe({entryTypes:["resource"]});new PerformanceObserver(e=>{const t=e.getEntries();t[t.length-1]}).observe({entryTypes:["largest-contentful-paint"]})}catch(e){}}applyImageLazyLoading(){try{if("IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const a=t.target;a.dataset.src&&(a.src=a.dataset.src,a.removeAttribute("data-src"),e.unobserve(a))}})},{rootMargin:"50px 0px",threshold:.01});return document.querySelectorAll("img[data-src]").forEach(t=>e.observe(t)),this.optimizations.set("imageLazyLoading",!0),!0}return!1}catch(e){return!1}}prefetchCriticalResources(){try{return["/api/budget","/api/expenses","/api/categories"].forEach(e=>{const t=document.createElement("link");t.rel="prefetch",t.href=e,document.head.appendChild(t)}),this.optimizations.set("resourcePrefetching",!0),!0}catch(e){return!1}}enablePassiveEventListeners(){try{const e=EventTarget.prototype.addEventListener;return EventTarget.prototype.addEventListener=function(t,a,n){const r=["scroll","touchstart","touchmove","wheel"];return r.includes(t)&&"object"!=typeof n?n={passive:!0}:"object"==typeof n&&void 0===n.passive&&(n.passive=r.includes(t)),e.call(this,t,a,n)},this.optimizations.set("passiveEventListeners",!0),!0}catch(e){return!1}}optimizeScrollPerformance(){try{let e=null;const t=window.onscroll;window.onscroll=a=>{e&&cancelAnimationFrame(e),e=requestAnimationFrame(()=>{t&&t.call(window,a)})};const a=document.createElement("style");return a.textContent="\n        .page-container {\n          contain: layout style paint;\n        }\n        .list-item {\n          contain: layout;\n        }\n      ",document.head.appendChild(a),this.optimizations.set("scrollOptimization",!0),!0}catch(e){return!1}}enableMemoryCleanup(){try{return setInterval(()=>{this.performMemoryCleanup()},6e4),document.addEventListener("visibilitychange",()=>{document.hidden&&this.performMemoryCleanup()}),this.optimizations.set("memoryCleanup",!0),!0}catch(e){return!1}}performMemoryCleanup(){try{performance.clearResourceTimings&&performance.clearResourceTimings(),"gc"in window&&window.gc(),this.clearUnusedImageCaches()}catch(e){}}clearUnusedImageCaches(){document.querySelectorAll("img").forEach(e=>{if(!e.offsetParent&&!e.style.display){const t=e.src;e.src="",e.src=t}})}analyzeResourceTiming(e){const t={totalResources:e.length,slowResources:0,cachedResources:0,totalTransferSize:0};e.forEach(e=>{const a=e;e.duration>1e3&&t.slowResources++,0===a.transferSize&&a.decodedBodySize>0&&t.cachedResources++,t.totalTransferSize+=a.transferSize||0}),this.metrics.cacheHitRate=t.cachedResources/t.totalResources}scheduleMetricsCollection(){setInterval(()=>{this.collectCurrentMetrics()},3e4)}collectCurrentMetrics(){try{if("memory"in performance){const e=performance.memory;this.metrics.memoryUsage=e.usedJSHeapSize/1048576}if(performance.getEntriesByType){const e=performance.getEntriesByType("resource").filter(e=>e.name.includes(".js"));this.metrics.bundleSize=e.reduce((e,t)=>e+(t.transferSize||0),0)/1024}}catch(e){}}getCurrentMetrics(){return{loadTime:this.metrics.loadTime||0,renderTime:this.metrics.renderTime||0,memoryUsage:this.metrics.memoryUsage||0,bundleSize:this.metrics.bundleSize||0,cacheHitRate:this.metrics.cacheHitRate||0}}getOptimizationStatus(){return Object.fromEntries(this.optimizations)}generatePerformanceReport(){const e=this.getCurrentMetrics(),t=this.getOptimizationStatus(),a=[];return e.loadTime>3e3&&a.push("Consider code splitting to reduce initial bundle size"),e.memoryUsage>50&&a.push("Memory usage is high, consider implementing virtual scrolling"),e.cacheHitRate<.5&&a.push("Improve caching strategy for better performance"),e.bundleSize>500&&a.push("Bundle size is large, consider lazy loading non-critical components"),{metrics:e,optimizations:t,recommendations:a}}};"undefined"!=typeof window&&Qe.initialize();const et=new class{performHealthCheck(){return c(this,null,function*(){const e={storage:yield this.checkStorage(),performance:yield this.checkPerformance(),memory:yield this.checkMemory(),connectivity:yield this.checkConnectivity(),features:yield this.checkFeatures()};return{overall:this.determineOverallHealth(e),checks:e,recommendations:this.generateRecommendations(e)}})}checkStorage(){return c(this,null,function*(){try{const e="__health_check_test__";if(localStorage.setItem(e,"test"),localStorage.removeItem(e),"storage"in navigator&&"estimate"in navigator.storage){const e=yield navigator.storage.estimate(),t=(e.usage||0)/1048576,a=(e.quota||0)/1048576,n=t/a*100;return n>90?{status:"error",message:"Storage quota nearly exceeded",details:{usedMB:t,quotaMB:a,usagePercent:n},timestamp:new Date}:n>70?{status:"warning",message:"Storage usage is high",details:{usedMB:t,quotaMB:a,usagePercent:n},timestamp:new Date}:{status:"healthy",message:"Storage is available and healthy",details:{usedMB:t,quotaMB:a,usagePercent:n},timestamp:new Date}}return{status:"healthy",message:"localStorage is available",timestamp:new Date}}catch(e){return{status:"error",message:"Storage is not available",details:{error:e instanceof Error?e.message:"Unknown error"},timestamp:new Date}}})}checkPerformance(){return c(this,null,function*(){try{if("performance"in window&&"getEntriesByType"in performance){const e=performance.getEntriesByType("navigation")[0];if(e){const t=e.loadEventEnd-e.fetchStart,a=e.domContentLoadedEventEnd-e.fetchStart;return t>5e3?{status:"error",message:"Application load time is too slow",details:{loadTime:t,domContentLoaded:a},timestamp:new Date}:t>3e3?{status:"warning",message:"Application load time is slow",details:{loadTime:t,domContentLoaded:a},timestamp:new Date}:{status:"healthy",message:"Application performance is good",details:{loadTime:t,domContentLoaded:a},timestamp:new Date}}}return{status:"healthy",message:"Performance monitoring not available",timestamp:new Date}}catch(e){return{status:"warning",message:"Unable to check performance",details:{error:e instanceof Error?e.message:"Unknown error"},timestamp:new Date}}})}checkMemory(){return c(this,null,function*(){try{if("memory"in performance){const e=performance.memory,t=e.usedJSHeapSize/1048576,a=e.totalJSHeapSize/1048576,n=e.jsHeapSizeLimit/1048576,r=t/n*100;return r>90?{status:"error",message:"Memory usage is critically high",details:{usedMB:t,totalMB:a,limitMB:n,usagePercent:r},timestamp:new Date}:r>70?{status:"warning",message:"Memory usage is high",details:{usedMB:t,totalMB:a,limitMB:n,usagePercent:r},timestamp:new Date}:{status:"healthy",message:"Memory usage is normal",details:{usedMB:t,totalMB:a,limitMB:n,usagePercent:r},timestamp:new Date}}return{status:"healthy",message:"Memory monitoring not available",timestamp:new Date}}catch(e){return{status:"warning",message:"Unable to check memory usage",details:{error:e instanceof Error?e.message:"Unknown error"},timestamp:new Date}}})}checkConnectivity(){return c(this,null,function*(){try{if("navigator"in window&&"onLine"in navigator){if(!navigator.onLine)return{status:"warning",message:"Application is offline",details:{online:!1},timestamp:new Date};if("connection"in navigator){const e=navigator.connection,t=e.effectiveType;return"slow-2g"===t||"2g"===t?{status:"warning",message:"Slow network connection detected",details:{effectiveType:t,downlink:e.downlink},timestamp:new Date}:{status:"healthy",message:"Network connection is good",details:{effectiveType:t,downlink:e.downlink},timestamp:new Date}}return{status:"healthy",message:"Application is online",details:{online:!0},timestamp:new Date}}return{status:"healthy",message:"Connectivity monitoring not available",timestamp:new Date}}catch(e){return{status:"warning",message:"Unable to check connectivity",details:{error:e instanceof Error?e.message:"Unknown error"},timestamp:new Date}}})}checkFeatures(){return c(this,null,function*(){const e=[],t={};try{t.localStorage="localStorage"in window,t.localStorage||e.push("localStorage not available"),t.es6="undefined"!=typeof Symbol,t.es6||e.push("ES6 features not supported"),t.cssGrid=CSS.supports("display","grid"),t.cssFlexbox=CSS.supports("display","flex"),t.cssGrid&&t.cssFlexbox||e.push("Modern CSS features not supported"),t.touch="ontouchstart"in window||navigator.maxTouchPoints>0;const a=document.querySelector('meta[name="viewport"]');return t.viewport=!!a,t.viewport||e.push("Viewport meta tag missing"),t.serviceWorker="serviceWorker"in navigator,e.length>3?{status:"error",message:"Multiple critical features are missing",details:{features:t,issues:e},timestamp:new Date}:e.length>0?{status:"warning",message:"Some features are not available",details:{features:t,issues:e},timestamp:new Date}:{status:"healthy",message:"All critical features are available",details:{features:t},timestamp:new Date}}catch(a){return{status:"error",message:"Unable to check application features",details:{error:a instanceof Error?a.message:"Unknown error"},timestamp:new Date}}})}determineOverallHealth(e){const t=Object.values(e).map(e=>e.status);return t.includes("error")?"error":t.includes("warning")?"warning":"healthy"}generateRecommendations(e){const t=[];return"error"===e.storage.status?t.push("Clear browser data or use a different browser"):"warning"===e.storage.status&&t.push("Consider clearing old data to free up storage space"),"error"===e.performance.status?t.push("Close other browser tabs and applications to improve performance"):"warning"===e.performance.status&&t.push("Consider refreshing the page or restarting the browser"),"error"===e.memory.status?t.push("Restart the browser to free up memory"):"warning"===e.memory.status&&t.push("Close unnecessary browser tabs"),"warning"===e.connectivity.status&&t.push("Check your internet connection for better experience"),"error"===e.features.status?t.push("Update your browser to the latest version"):"warning"===e.features.status&&t.push("Some features may not work optimally in this browser"),0===t.length&&t.push("System is running optimally"),t}getSystemInfo(){return{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,screen:{width:screen.width,height:screen.height,colorDepth:screen.colorDepth},viewport:{width:window.innerWidth,height:window.innerHeight},timestamp:(new Date).toISOString()}}};var tt=Object.defineProperty,at=(e,t,a)=>((e,t,a)=>t in e?tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);const nt=new class{constructor(){at(this,"app",null),at(this,"router",null),at(this,"config"),at(this,"status"),at(this,"healthCheckInterval",null),this.config={enablePerformanceMonitoring:!0,enableHealthChecks:!0,enableErrorReporting:!0,enableAnalytics:!1,debugMode:!1},this.status={initialized:!1,modules:{router:!1,storage:!1,performance:!1,errorHandling:!1,analytics:!1},health:"healthy",lastCheck:new Date}}initialize(e,t,a){return c(this,null,function*(){this.app=e,this.router=t,a&&(this.config=o(o({},this.config),a));try{yield this.initializeRouter(),yield this.initializeStorage(),yield this.initializePerformanceMonitoring(),yield this.initializeErrorHandling(),yield this.initializeHealthChecks(),this.config.enableAnalytics&&(yield this.initializeAnalytics()),this.status.initialized=!0,this.log("Integration service initialized successfully"),this.startHealthChecks()}catch(n){throw this.logError("Failed to initialize integration service",n),n}})}initializeRouter(){return c(this,null,function*(){if(!this.router)throw new Error("Router not provided");try{this.router.beforeEach((e,t,a)=>{this.log(`Navigating from ${t.name} to ${e.name}`),this.config.enablePerformanceMonitoring&&performance.mark(`navigation-start-${e.name}`),a()}),this.router.afterEach((e,t)=>{var a;this.config.enablePerformanceMonitoring&&(performance.mark(`navigation-end-${e.name}`),performance.measure(`navigation-${e.name}`,`navigation-start-${e.name}`,`navigation-end-${e.name}`)),(null==(a=e.meta)?void 0:a.title)&&(document.title=`${e.meta.title} - 月度预算跟踪器`)}),this.router.onError(e=>{this.logError("Router error",e)}),this.status.modules.router=!0,this.log("Router integration initialized")}catch(e){throw this.logError("Router initialization failed",e),e}})}initializeStorage(){return c(this,null,function*(){try{const e="__integration_test__";if(localStorage.setItem(e,"test"),localStorage.removeItem(e),window.addEventListener("storage",e=>{this.log("Storage changed",{key:e.key,newValue:e.newValue})}),"storage"in navigator&&"estimate"in navigator.storage){const e=yield navigator.storage.estimate();e.usage,e.quota}this.status.modules.storage=!0,this.log("Storage integration initialized")}catch(e){throw this.logError("Storage initialization failed",e),e}})}initializePerformanceMonitoring(){return c(this,null,function*(){if(this.config.enablePerformanceMonitoring)try{this.setupCustomPerformanceTracking(),this.status.modules.performance=!0,this.log("Performance monitoring initialized")}catch(e){this.logError("Performance monitoring initialization failed",e)}})}setupCustomPerformanceTracking(){this.app&&this.config.debugMode&&(this.app.config.performance=!0);const e=e=>{performance.mark(`interaction-${e}-${Date.now()}`)};document.addEventListener("click",()=>e("click"),{passive:!0}),document.addEventListener("scroll",()=>e("scroll"),{passive:!0})}initializeErrorHandling(){return c(this,null,function*(){if(this.config.enableErrorReporting)try{window.addEventListener("error",e=>{this.logError("Global error",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error})}),window.addEventListener("unhandledrejection",e=>{this.logError("Unhandled promise rejection",e.reason)}),this.app&&(this.app.config.errorHandler=(e,t,a)=>{this.logError("Vue error",{error:e,info:a})}),this.status.modules.errorHandling=!0,this.log("Error handling initialized")}catch(e){this.logError("Error handling initialization failed",e)}})}initializeHealthChecks(){return c(this,null,function*(){if(this.config.enableHealthChecks)try{const e=yield et.performHealthCheck();this.status.health=e.overall,this.status.lastCheck=new Date,this.log("Health checks initialized",{health:e.overall})}catch(e){this.logError("Health checks initialization failed",e)}})}initializeAnalytics(){return c(this,null,function*(){try{this.status.modules.analytics=!0,this.log("Analytics initialized")}catch(e){this.logError("Analytics initialization failed",e)}})}startHealthChecks(){this.config.enableHealthChecks&&(this.healthCheckInterval=window.setInterval(()=>c(this,null,function*(){try{const e=yield et.performHealthCheck();this.status.health=e.overall,this.status.lastCheck=new Date,"error"===e.overall?this.logError("Health check failed",e):e.overall}catch(e){this.logError("Health check error",e)}}),3e5))}stopHealthChecks(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}getStatus(){return o({},this.status)}getPerformanceReport(){return c(this,null,function*(){return this.config.enablePerformanceMonitoring?Qe.generatePerformanceReport():null})}getHealthReport(){return c(this,null,function*(){return this.config.enableHealthChecks?yield et.performHealthCheck():null})}cleanup(){this.stopHealthChecks(),this.log("Integration service cleaned up")}log(e,t){this.config.debugMode}logError(e,t){}updateConfig(e){this.config=o(o({},this.config),e),this.log("Configuration updated",this.config)}restartHealthChecks(e=3e5){this.stopHealthChecks(),this.config.enableHealthChecks&&(this.healthCheckInterval=window.setInterval(()=>c(this,null,function*(){try{const e=yield et.performHealthCheck();this.status.health=e.overall,this.status.lastCheck=new Date}catch(e){this.logError("Health check error",e)}}),e))}},rt=W(Ke);var st,it,ot;!function(e){const t=(se||(se=re()),se);e.config.errorHandler=(e,a,n)=>{var r,s,i;const o=(null==(r=null==a?void 0:a.$options)?void 0:r.name)||(null==(s=null==a?void 0:a.$options)?void 0:s.__name)||"Unknown";t.handleComponentError(o,e,{info:n,instance:null==(i=null==a?void 0:a.$el)?void 0:i.tagName})},window.addEventListener("unhandledrejection",e=>{t.handleError(e.reason,{showToast:!0,logToConsole:!0})}),window.addEventListener("error",e=>{t.handleError(e.error||new Error(e.message),{showToast:!0,logToConsole:!0,context:{filename:e.filename,lineno:e.lineno,colno:e.colno}})})}(rt),rt.use(F()),rt.use(Xe),(st=rt,it=Xe,ot={enablePerformanceMonitoring:!0,enableHealthChecks:!0,enableErrorReporting:!0,enableAnalytics:!1,debugMode:!1},nt.initialize(st,it,ot)).then(()=>{}).catch(e=>{}),rt.mount("#app");export{ne as D,ce as _,Q as g};
