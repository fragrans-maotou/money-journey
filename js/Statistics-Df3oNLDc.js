var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,o=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&r(e,t,a[t]);if(s)for(var t of s(a))l.call(a,t)&&r(e,t,a[t]);return e},i=(e,s)=>a(e,t(s));import{r as c,c as d,b as u,d as g,A as v,o as m,a as h,e as p,f as y,i as b,F as D,m as w,t as k,y as x,g as f,M,h as A,x as C,I as $,J as I,z as T,s as F}from"./vue-vendor-GQR5GLLq.js";import{u as S}from"./useExpense-oBx4eHDE.js";import{u as B}from"./useBudget-BWijnOHX.js";import{_ as E}from"./index-DLCvt2vX.js";import"./useStorage-CghUNedP.js";const P={class:"chart-view"},N={class:"chart-tabs"},O=["onClick"],H={class:"chart-tab-icon"},R={class:"chart-tab-label"},j={class:"chart-container"},L={key:0,class:"chart-loading"},Y={key:1,class:"chart-error"},_={key:2,class:"chart-empty"},q={key:3,class:"chart-content"},U={key:0,class:"pie-chart"},z=["transform"],V=["d","fill","onMouseenter","onClick"],J={class:"pie-center-text","text-anchor":"middle",dy:"0.35em"},Z={class:"pie-total-amount",x:"0",dy:"1.2em"},G={class:"chart-legend"},K=["onMouseenter","onClick"],Q={class:"legend-content"},W={class:"legend-name"},X={class:"legend-value"},ee={class:"legend-amount"},ae={class:"legend-percentage"},te={key:1,class:"line-chart"},se={class:"grid"},ne=["x1","y1","x2","y2"],le=["x1","y1","x2","y2"],re={class:"y-axis"},oe=["x","y"],ie={class:"x-axis"},ce=["x","y"],de=["d"],ue=["cx","cy","r","onMouseenter"],ge={class:"tooltip-date"},ve={class:"tooltip-amount"},me={key:2,class:"bar-chart"},he={class:"grid"},pe=["x1","y1","x2","y2"],ye={class:"y-axis"},be=["x","y"],De=["x","y","width","height","fill","onMouseenter","onClick"],we={class:"x-axis"},ke=["x","y"],xe={class:"tooltip-category"},fe={class:"tooltip-amount"},Me={class:"tooltip-percentage"},Ae={key:3,class:"heatmap-chart"},Ce={class:"heatmap-grid"},$e={class:"heatmap-weeks"},Ie=["onMouseenter"],Te={class:"cell-date"},Fe={class:"heatmap-legend"},Se={class:"legend-gradient"},Be={class:"tooltip-date"},Ee={class:"tooltip-amount"},Pe=280,Ne=360,Oe=240,He=E(g({__name:"ChartView",props:{categoryBreakdown:{},dailyTrend:{},categories:{},isLoading:{type:Boolean,default:!1},error:{default:null},chartType:{default:"pie"}},emits:["segment-click","legend-click","bar-click","retry"],setup(e){const a=e,t=c(a.chartType),s=c(null),n=c(null),l=c(null),r=c({visible:!1,x:0,y:0,date:"",amount:0,categoryName:"",percentage:""}),u=[{value:"pie",label:"分类占比",icon:"🥧"},{value:"line",label:"消费趋势",icon:"📈"},{value:"bar",label:"分类对比",icon:"📊"},{value:"heatmap",label:"消费热力图",icon:"🔥"}],g=20,C=20,$=40,I=60,T=d(()=>a.categoryBreakdown.length>0||a.dailyTrend.length>0),F=d(()=>a.categoryBreakdown.reduce((e,a)=>e+a.amount,0)),S=d(()=>{if(0===a.categoryBreakdown.length)return[];const e=F.value;let t=-Math.PI/2;return a.categoryBreakdown.map((a,s)=>{const n=2*(a.amount/e)*Math.PI,l=120,r=t,c=t+n,d=Math.cos(r)*l,u=Math.sin(r)*l,g=Math.cos(c)*l,v=Math.sin(c)*l,m=["M 0 0",`L ${d} ${u}`,`A 120 120 0 ${n>Math.PI?1:0} 1 ${g} ${v}`,"Z"].join(" ");return t+=n,i(o({},a),{path:m,color:Ue(a.categoryId),startAngle:r,endAngle:c,percentage:a.percentage})})}),B=d(()=>{if(0===a.dailyTrend.length)return[];const e=Math.max(...a.dailyTrend.map(e=>e.amount)),t=Math.min(...a.dailyTrend.map(e=>e.amount)),s=e-t||1,n=Ne-I-C,l=Oe-g-$;return a.dailyTrend.map((e,r)=>({x:I+r/(a.dailyTrend.length-1)*n,y:g+l-(e.amount-t)/s*l,amount:e.amount,date:e.date,index:r}))}),E=d(()=>0===B.value.length?"":B.value.map((e,a)=>`${0===a?"M":"L"} ${e.x} ${e.y}`).join(" ")),He=d(()=>{if(0===a.categoryBreakdown.length)return[];const e=Math.max(...a.categoryBreakdown.map(e=>e.amount)),t=Ne-I-C,s=Oe-g-$,n=t/a.categoryBreakdown.length*.8,l=t/a.categoryBreakdown.length*.2;return a.categoryBreakdown.map((a,t)=>{const r=a.amount/e*s,c=I+t*(n+l)+l/2,d=g+s-r;return i(o({},a),{x:c,y:d,width:n,height:r})})}),Re=d(()=>{const e=[];"line"===t.value?Math.max(...a.dailyTrend.map(e=>e.amount)):Math.max(...a.categoryBreakdown.map(e=>e.amount));const s=Oe-g-$;for(let a=0;a<=5;a++){const t=g+a/5*s;e.push(t)}return e}),je=d(()=>{if("line"!==t.value)return[];const e=[],s=Ne-I-C,n=a.dailyTrend.length;for(let a=0;a<n;a+=Math.ceil(n/6)){const t=I+a/(n-1)*s;e.push(t)}return e}),Le=d(()=>{const e=[],s="line"===t.value?Math.max(...a.dailyTrend.map(e=>e.amount)):Math.max(...a.categoryBreakdown.map(e=>e.amount)),n=Oe-g-$;for(let a=0;a<=5;a++){const t=s/5*(5-a),l=g+a/5*n;e.push({value:t,y:l})}return e}),Ye=d(()=>{if("line"!==t.value)return[];const e=[],s=Ne-I-C,n=a.dailyTrend.length;for(let t=0;t<n;t+=Math.ceil(n/6)){const l=a.dailyTrend[t];if(l){const a=I+t/(n-1)*s,r=new Date(l.date),o=`${r.getMonth()+1}/${r.getDate()}`;e.push({x:a,text:o})}}return e}),_e=d(()=>{if(0===a.dailyTrend.length)return[];const e=[];let t=[];const s=a.dailyTrend[0].date,n=s.getDay();for(let a=0;a<n;a++){const e=new Date(s);e.setDate(s.getDate()-(n-a)),t.push({date:e,amount:0})}for(a.dailyTrend.forEach(a=>{t.push({date:a.date,amount:a.amount}),7===t.length&&(e.push([...t]),t=[])});t.length<7&&t.length>0;){const e=t[t.length-1].date,a=new Date(e);a.setDate(e.getDate()+1),t.push({date:a,amount:0})}return t.length>0&&e.push(t),e}),qe=d(()=>Math.max(...a.dailyTrend.map(e=>e.amount),1)),Ue=e=>{const t=a.categories.find(a=>a.id===e);return(null==t?void 0:t.color)||"#95A5A6"},ze=e=>e>=1e4?(e/1e4).toFixed(1)+"万":e>=1e3?(e/1e3).toFixed(1)+"k":e.toFixed(0),Ve=()=>{r.value.visible=!1},Je=(e,a)=>{if(0===e)return"#F2F2F7";const t=e/a,s=[0,122,255],n=Math.max(.1,t);return`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${n})`};return v(()=>a.chartType,e=>{t.value=e}),m(()=>{document.addEventListener("click",Ve)}),h(()=>{document.removeEventListener("click",Ve)}),(e,a)=>(y(),p("div",P,[b("div",N,[(y(),p(D,null,w(u,e=>b("button",{key:e.value,class:A(["chart-tab",{active:t.value===e.value}]),onClick:a=>(e=>{t.value=e})(e.value)},[b("span",H,k(e.icon),1),b("span",R,k(e.label),1)],10,O)),64))]),b("div",j,[e.isLoading?(y(),p("div",L,[...a[6]||(a[6]=[b("div",{class:"loading-spinner"},null,-1),b("p",null,"加载中...",-1)])])):e.error?(y(),p("div",Y,[a[7]||(a[7]=b("span",{class:"error-icon"},"⚠️",-1)),b("p",null,k(e.error),1),b("button",{class:"retry-button",onClick:a[0]||(a[0]=a=>e.$emit("retry"))},"重试")])):T.value?(y(),p("div",q,["pie"===t.value?(y(),p("div",U,[(y(),p("svg",{width:Pe,height:Pe,class:"pie-svg"},[b("g",{transform:"translate(140, 140)"},[(y(!0),p(D,null,w(S.value,(t,n)=>(y(),p("path",{key:t.categoryId,d:t.path,fill:t.color,class:A(["pie-segment",{active:s.value===n}]),onMouseenter:e=>s.value=n,onMouseleave:a[1]||(a[1]=e=>s.value=null),onClick:a=>e.$emit("segment-click",t)},null,42,V))),128)),b("text",J,[a[9]||(a[9]=b("tspan",{class:"pie-total-label",x:"0",dy:"-0.5em"},"总消费",-1)),b("tspan",Z,"¥"+k(ze(F.value)),1)])],8,z)])),b("div",G,[(y(!0),p(D,null,w(e.categoryBreakdown,(t,n)=>(y(),p("div",{key:t.categoryId,class:A(["legend-item",{active:s.value===n}]),onMouseenter:e=>s.value=n,onMouseleave:a[2]||(a[2]=e=>s.value=null),onClick:a=>e.$emit("legend-click",t)},[b("div",{class:"legend-color",style:f({backgroundColor:Ue(t.categoryId)})},null,4),b("div",Q,[b("div",W,k(t.categoryName),1),b("div",X,[b("span",ee,"¥"+k(ze(t.amount)),1),b("span",ae,k(t.percentage.toFixed(1))+"%",1)])])],42,K))),128))])])):x("",!0),"line"===t.value?(y(),p("div",te,[(y(),p("svg",{width:Ne,height:Oe,class:"line-svg"},[b("g",se,[(y(!0),p(D,null,w(Re.value,e=>(y(),p("line",{key:`h-${e}`,x1:I,y1:e,x2:Ne-C,y2:e,class:"grid-line"},null,8,ne))),128)),(y(!0),p(D,null,w(je.value,e=>(y(),p("line",{key:`v-${e}`,x1:e,y1:g,x2:e,y2:Oe-$,class:"grid-line"},null,8,le))),128))]),b("g",re,[(y(!0),p(D,null,w(Le.value,(e,a)=>(y(),p("text",{key:`y-${a}`,x:I-10,y:e.y,class:"axis-label","text-anchor":"end",dy:"0.35em"}," ¥"+k(ze(e.value)),9,oe))),128))]),b("g",ie,[(y(!0),p(D,null,w(Ye.value,(e,a)=>(y(),p("text",{key:`x-${a}`,x:e.x,y:Oe-$+20,class:"axis-label","text-anchor":"middle"},k(e.text),9,ce))),128))]),b("path",{d:E.value,class:"trend-line",fill:"none",stroke:"#007AFF","stroke-width":"2"},null,8,de),(y(!0),p(D,null,w(B.value,(e,t)=>(y(),p("circle",{key:`point-${t}`,cx:e.x,cy:e.y,r:n.value===t?6:4,class:A(["trend-point",{active:n.value===t}]),onMouseenter:a=>{n.value=t,(e=>{var a;const t=null==(a=document.querySelector(".line-chart"))?void 0:a.getBoundingClientRect();t&&(r.value={visible:!0,x:e.x+t.left,y:e.y+t.top-40,date:new Date(e.date).toLocaleDateString(),amount:e.amount,categoryName:"",percentage:""})})(e)},onMouseleave:a[3]||(a[3]=e=>{n.value=null,Ve()})},null,42,ue))),128))])),r.value.visible?(y(),p("div",{key:0,class:"chart-tooltip",style:f({left:r.value.x+"px",top:r.value.y+"px"})},[b("div",ge,k(r.value.date),1),b("div",ve,"¥"+k(ze(r.value.amount)),1)],4)):x("",!0)])):x("",!0),"bar"===t.value?(y(),p("div",me,[(y(),p("svg",{width:Ne,height:Oe,class:"bar-svg"},[b("g",he,[(y(!0),p(D,null,w(Re.value,e=>(y(),p("line",{key:`h-${e}`,x1:I,y1:e,x2:Ne-C,y2:e,class:"grid-line"},null,8,pe))),128))]),b("g",ye,[(y(!0),p(D,null,w(Le.value,(e,a)=>(y(),p("text",{key:`y-${a}`,x:I-10,y:e.y,class:"axis-label","text-anchor":"end",dy:"0.35em"}," ¥"+k(ze(e.value)),9,be))),128))]),(y(!0),p(D,null,w(He.value,(t,s)=>(y(),p("rect",{key:`bar-${s}`,x:t.x,y:t.y,width:t.width,height:t.height,class:A(["bar",{active:l.value===s}]),fill:Ue(t.categoryId),onMouseenter:e=>{l.value=s,(e=>{var a;const t=null==(a=document.querySelector(".bar-chart"))?void 0:a.getBoundingClientRect();t&&(r.value={visible:!0,x:e.x+e.width/2+t.left,y:e.y+t.top-40,date:"",amount:e.amount,categoryName:e.categoryName,percentage:e.percentage.toFixed(1)})})(t)},onMouseleave:a[4]||(a[4]=e=>{l.value=null,Ve()}),onClick:a=>e.$emit("bar-click",t)},null,42,De))),128)),b("g",we,[(y(!0),p(D,null,w(He.value,(e,a)=>(y(),p("text",{key:`x-${a}`,x:e.x+e.width/2,y:Oe-$+20,class:"axis-label bar-label","text-anchor":"middle"},k(e.categoryName),9,ke))),128))])])),r.value.visible?(y(),p("div",{key:0,class:"chart-tooltip",style:f({left:r.value.x+"px",top:r.value.y+"px"})},[b("div",xe,k(r.value.categoryName),1),b("div",fe,"¥"+k(ze(r.value.amount)),1),b("div",Me,k(r.value.percentage)+"%",1)],4)):x("",!0)])):x("",!0),"heatmap"===t.value?(y(),p("div",Ae,[a[13]||(a[13]=b("div",{class:"heatmap-header"},[b("h4",{class:"heatmap-title"},"消费热力图"),b("p",{class:"heatmap-subtitle"},"颜色越深表示消费越多")],-1)),b("div",Ce,[a[10]||(a[10]=M('<div class="heatmap-days" data-v-da54b952><div class="day-label" data-v-da54b952>日</div><div class="day-label" data-v-da54b952>一</div><div class="day-label" data-v-da54b952>二</div><div class="day-label" data-v-da54b952>三</div><div class="day-label" data-v-da54b952>四</div><div class="day-label" data-v-da54b952>五</div><div class="day-label" data-v-da54b952>六</div></div>',1)),b("div",$e,[(y(!0),p(D,null,w(_e.value,(e,t)=>(y(),p("div",{key:`week-${t}`,class:"heatmap-week"},[(y(!0),p(D,null,w(e,(e,s)=>(y(),p("div",{key:`day-${t}-${s}`,class:A(["heatmap-cell",{"has-data":e.amount>0}]),style:f({backgroundColor:Je(e.amount,qe.value),opacity:e.amount>0?1:.3}),onMouseenter:a=>((e,a)=>{const t=a.target.getBoundingClientRect();r.value={visible:!0,x:t.left+t.width/2,y:t.top-40,date:e.date.toLocaleDateString(),amount:e.amount,categoryName:"",percentage:""}})(e,a),onMouseleave:a[5]||(a[5]=e=>Ve())},[b("span",Te,k(e.date.getDate()),1)],46,Ie))),128))]))),128))])]),b("div",Fe,[a[11]||(a[11]=b("span",{class:"legend-label"},"少",-1)),b("div",Se,[(y(),p(D,null,w(5,e=>b("div",{key:e,class:"legend-step",style:f({backgroundColor:Je(e/5*qe.value,qe.value)})},null,4)),64))]),a[12]||(a[12]=b("span",{class:"legend-label"},"多",-1))]),r.value.visible?(y(),p("div",{key:0,class:"chart-tooltip",style:f({left:r.value.x+"px",top:r.value.y+"px"})},[b("div",Be,k(r.value.date),1),b("div",Ee,"¥"+k(ze(r.value.amount)),1)],4)):x("",!0)])):x("",!0)])):(y(),p("div",_,[...a[8]||(a[8]=[b("span",{class:"empty-icon"},"📊",-1),b("p",null,"暂无数据",-1),b("p",{class:"empty-subtitle"},"开始记录消费后，这里将显示统计图表",-1)])]))])]))}}),[["__scopeId","data-v-da54b952"]]),Re={class:"statistics-view"},je={class:"nav-bar"},Le={class:"picker-header"},Ye={class:"picker-options"},_e=["onClick"],qe={class:"option-icon"},Ue={class:"option-label"},ze={key:0,class:"custom-date-range"},Ve={class:"date-input-group"},Je={class:"date-input-group"},Ze={class:"statistics-content"},Ge={class:"overview-cards"},Ke={class:"overview-card"},Qe={class:"card-content"},We={class:"card-value"},Xe={class:"overview-card"},ea={class:"card-content"},aa={class:"card-value"},ta={class:"overview-card"},sa={class:"card-content"},na={class:"card-value"},la={key:0,class:"overview-card"},ra={class:"card-content"},oa={class:"card-value"},ia={key:0,class:"budget-analysis"},ca={class:"budget-progress"},da={class:"progress-header"},ua={class:"progress-info"},ga={class:"progress-value"},va={class:"progress-bar"},ma={class:"progress-details"},ha={class:"detail-item"},pa={class:"detail-value"},ya={class:"detail-item"},ba={class:"detail-value"},Da={class:"detail-item"},wa={class:"detail-value"},ka={class:"detail-item"},xa={class:"detail-value"},fa={class:"enhanced-budget-analysis"},Ma={class:"analysis-row"},Aa={class:"analysis-item"},Ca={class:"analysis-item"},$a={key:0,class:"savings-opportunity"},Ia={class:"savings-content"},Ta={class:"savings-amount"},Fa={class:"chart-section"},Sa={class:"category-ranking"},Ba={key:0,class:"empty-state"},Ea={key:1,class:"ranking-list"},Pa=["onClick"],Na={class:"ranking-position"},Oa={class:"ranking-category"},Ha={class:"category-info"},Ra={class:"category-icon"},ja={class:"category-name"},La={class:"category-stats"},Ya={class:"category-amount"},_a={class:"category-percentage"},qa={class:"ranking-bar"},Ua={class:"trend-analysis"},za={key:0,class:"trend-summary"},Va={class:"trend-card"},Ja={class:"trend-content"},Za={class:"trend-description"},Ga={class:"trend-stats"},Ka={class:"stat-item"},Qa={class:"stat-value"},Wa={class:"stat-item"},Xa={class:"stat-value"},et={class:"stat-item"},at={class:"stat-value"},tt={class:"enhanced-trend-analysis"},st={class:"trend-comparison"},nt={class:"trend-period"},lt={class:"period-value"},rt={class:"trend-arrow"},ot={key:0,class:"arrow-up"},it={key:1,class:"arrow-down"},ct={key:2,class:"arrow-stable"},dt={class:"trend-period"},ut={class:"period-value"},gt={class:"weekday-weekend-comparison"},vt={class:"comparison-item"},mt={class:"comparison-value"},ht={class:"comparison-item"},pt={class:"comparison-value"},yt={key:0,class:"momentum-indicator"},bt={class:"momentum-icon"},Dt={class:"momentum-text"},wt={key:1,class:"historical-comparison"},kt={class:"comparison-summary"},xt={class:"comparison-card"},ft={class:"comparison-period"},Mt={class:"period-amount"},At={class:"period-count"},Ct={class:"comparison-arrow"},$t={key:0,class:"arrow-up"},It={key:1,class:"arrow-down"},Tt={key:2,class:"arrow-stable"},Ft={class:"comparison-period"},St={class:"period-amount"},Bt={class:"period-count"},Et={class:"comparison-change"},Pt={class:"detailed-comparison"},Nt={class:"comparison-metrics"},Ot={class:"metric-item"},Ht={class:"metric-values"},Rt={class:"current-value"},jt={class:"previous-value"},Lt={class:"metric-item"},Yt={class:"metric-values"},_t={class:"current-value"},qt={class:"previous-value"},Ut={key:0,class:"budget-comparison"},zt={class:"budget-comparison-card"},Vt={class:"budget-metric"},Jt={class:"budget-metric"},Zt={class:"budget-change"},Gt={key:1,class:"category-comparison"},Kt={class:"comparison-list"},Qt={class:"comparison-category"},Wt={class:"category-icon"},Xt={class:"category-name"},es={class:"comparison-values"},as=E(g({__name:"Statistics",setup(e){const{currentPeriod:a,currentDateRange:t,currentPeriodExpenses:s,categoryBreakdown:n,dailyTrend:l,currentStatistics:r,budgetAnalysis:o,historicalComparison:i,isLoading:g,error:h,setPeriod:M,setCustomDateRange:E,getTrendAnalysis:P,clearError:N}=function(){const{categories:e,getExpensesByDateRange:a}=S(),{budgetSummary:t,currentBudget:s}=B(),n=c("month"),l=c(new Date),r=c(new Date),o=c(!1),i=c(null),g=d(()=>{const e=new Date;switch(n.value){case"week":const a=new Date(e);a.setDate(e.getDate()-e.getDay()),a.setHours(0,0,0,0);const t=new Date(a);return t.setDate(a.getDate()+6),t.setHours(23,59,59,999),{startDate:a,endDate:t};case"month":const s=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0);return n.setHours(23,59,59,999),{startDate:s,endDate:n};case"custom":return{startDate:l.value,endDate:r.value};default:return{startDate:e,endDate:e}}}),v=d(()=>{const{startDate:e,endDate:t}=g.value;return a(e,t)}),m=d(()=>{const a=v.value,t=a.reduce((e,a)=>e+a.amount,0),s=new Map;return a.forEach(e=>{s.has(e.categoryId)||s.set(e.categoryId,{amount:0,count:0});const a=s.get(e.categoryId);a.amount+=e.amount,a.count+=1}),Array.from(s.entries()).map(([a,s])=>{const n=e.value.find(e=>e.id===a);return{categoryId:a,categoryName:(null==n?void 0:n.name)||"未知分类",amount:s.amount,percentage:t>0?s.amount/t*100:0}}).sort((e,a)=>a.amount-e.amount)}),h=d(()=>{const{startDate:e,endDate:a}=g.value,t=v.value,s=[],n=new Date(e);for(;n<=a;)s.push(new Date(n)),n.setDate(n.getDate()+1);const l=new Map;return t.forEach(e=>{try{const a=e.date instanceof Date?e.date:new Date(e.date);if(!isNaN(a.getTime())){const t=a.toISOString().split("T")[0];l.set(t,(l.get(t)||0)+e.amount)}}catch(a){}}),s.map(e=>({date:new Date(e),amount:l.get(e.toISOString().split("T")[0])||0}))}),p=d(()=>{const{startDate:e,endDate:a}=g.value,t=v.value.reduce((e,a)=>e+a.amount,0);let l=0;return s.value&&"month"===n.value&&(l=s.value.monthlyAmount>0?t/s.value.monthlyAmount*100:0),{period:n.value,startDate:e,endDate:a,totalSpent:t,budgetUtilization:l,categoryBreakdown:m.value,dailyTrend:h.value}}),y=d(()=>{if(!s.value||"month"!==n.value)return null;const e=t.value,a=e.totalSpent,l=e.totalBudget,r=e.remainingBudget,o=e.daysRemaining,i=l>0?a/l*100:0,c=new Date,d=new Date(c.getFullYear(),c.getMonth()+1,0).getDate(),u=c.getDate(),g=u/d*100,v=i,m=u>0?a/u:0,h=o>0?r/o:0,p=m*d,y=Math.max(0,p-l);let b="on_track",D="",w="low";return v>100?(b="over_budget",D="已超出月度预算",w="high"):p>1.1*l?(b="ahead",D="按当前消费速度，月末可能超预算",w="high"):v>g+15?(b="ahead",D="消费进度明显超前，建议控制支出",w="medium"):v>g+5?(b="ahead",D="消费进度略微超前，需要注意",w="low"):v<g-15?(b="behind",D="消费进度较慢，预算控制优秀",w="low"):v<g-5?(b="behind",D="消费进度稍慢，预算控制良好",w="low"):(b="on_track",D="消费进度正常，保持当前节奏",w="low"),{totalBudget:l,totalSpent:a,remainingBudget:r,achievementRate:i,expectedProgress:g,actualProgress:v,daysRemaining:o,status:b,message:D,isOverBudget:e.isOverBudget,dailyAverageSpent:m,recommendedDailySpend:h,projectedMonthEnd:p,savingsOpportunity:y,riskLevel:w}}),b=d(()=>{if("month"!==n.value)return null;const t=new Date,l={start:new Date(t.getFullYear(),t.getMonth(),1),end:new Date(t.getFullYear(),t.getMonth()+1,0)},r={start:new Date(t.getFullYear(),t.getMonth()-1,1),end:new Date(t.getFullYear(),t.getMonth(),0)},o=a(l.start,l.end),i=a(r.start,r.end),c=o.reduce((e,a)=>e+a.amount,0),d=i.reduce((e,a)=>e+a.amount,0),u=k(o,l.start,l.end),g=k(i,r.start,r.end),v=Math.max(...u,0),m=u.length>0?Math.min(...u.filter(e=>e>0)):0,h=u.length>0?c/u.length:0,p=Math.max(...g,0),y=g.length>0?Math.min(...g.filter(e=>e>0)):0,b=g.length>0?d/g.length:0,D=c-d,w=d>0?D/d*100:0,x=new Map,f=new Map;o.forEach(e=>{x.set(e.categoryId,(x.get(e.categoryId)||0)+e.amount)}),i.forEach(e=>{f.set(e.categoryId,(f.get(e.categoryId)||0)+e.amount)});const M=Array.from(new Set([...x.keys(),...f.keys()])).map(a=>{const t=e.value.find(e=>e.id===a),s=x.get(a)||0,n=f.get(a)||0,l=s-n,r=n>0?l/n*100:0;return{categoryId:a,categoryName:(null==t?void 0:t.name)||"未知分类",thisMonth:s,lastMonth:n,change:l,changePercentage:r}}).sort((e,a)=>Math.abs(a.change)-Math.abs(e.change));let A;if(s.value){const e=s.value.monthlyAmount,a=e>0?c/e*100:0,t=e>0?d/e*100:0;A={thisMonthBudget:e,lastMonthBudget:e,thisMonthAchievement:a,lastMonthAchievement:t,achievementChange:a-t}}return{thisMonth:{total:c,count:o.length,period:`${l.start.getFullYear()}年${l.start.getMonth()+1}月`,averageDaily:h,maxDaily:v,minDaily:m},lastMonth:{total:d,count:i.length,period:`${r.start.getFullYear()}年${r.start.getMonth()+1}月`,averageDaily:b,maxDaily:p,minDaily:y},change:{amount:D,percentage:w,trend:D>0?"increase":D<0?"decrease":"stable"},categoryComparison:M,budgetComparison:A}}),D=(t,n,l)=>{let r;if("custom"===t&&n&&l)r={startDate:n,endDate:l};else{const e=new Date;switch(t){case"week":const a=new Date(e);a.setDate(e.getDate()-e.getDay()),a.setHours(0,0,0,0);const t=new Date(a);t.setDate(a.getDate()+6),t.setHours(23,59,59,999),r={startDate:a,endDate:t};break;case"month":const s=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0);n.setHours(23,59,59,999),r={startDate:s,endDate:n};break;default:r={startDate:e,endDate:e}}}const o=a(r.startDate,r.endDate),i=o.reduce((e,a)=>e+a.amount,0),c=new Map;o.forEach(e=>{c.set(e.categoryId,(c.get(e.categoryId)||0)+e.amount)});const d=Array.from(c.entries()).map(([a,t])=>{const s=e.value.find(e=>e.id===a);return{categoryId:a,categoryName:(null==s?void 0:s.name)||"未知分类",amount:t,percentage:i>0?t/i*100:0}}).sort((e,a)=>a.amount-e.amount),u=new Map;o.forEach(e=>{try{const a=e.date instanceof Date?e.date:new Date(e.date);if(!isNaN(a.getTime())){const t=a.toISOString().split("T")[0];u.set(t,(u.get(t)||0)+e.amount)}}catch(a){}});const g=[],v=new Date(r.startDate);for(;v<=r.endDate;)g.push(new Date(v)),v.setDate(v.getDate()+1);const m=g.map(e=>({date:new Date(e),amount:u.get(e.toISOString().split("T")[0])||0}));let h=0;return s.value&&"month"===t&&(h=s.value.monthlyAmount>0?i/s.value.monthlyAmount*100:0),{period:t,startDate:r.startDate,endDate:r.endDate,totalSpent:i,budgetUtilization:h,categoryBreakdown:d,dailyTrend:m}},w=(e,a,t)=>{const s=[];"increasing"===a.direction&&a.momentum>20?s.push({type:"warning",title:"消费增长趋势",message:"最近消费呈明显上升趋势，建议关注支出控制",actionable:!0,priority:"high"}):"decreasing"===a.direction&&a.momentum<-20&&s.push({type:"success",title:"消费控制良好",message:"消费呈下降趋势，预算控制效果显著",actionable:!1,priority:"low"}),a.weekendAverage>1.5*a.weekdayAverage&&s.push({type:"info",title:"周末消费较高",message:`周末日均消费比工作日高${(100*(a.weekendAverage/a.weekdayAverage-1)).toFixed(0)}%`,actionable:!0,priority:"medium"}),a.volatility>.8*a.averageDaily&&s.push({type:"tip",title:"消费波动较大",message:"日消费金额变化较大，建议制定更稳定的消费计划",actionable:!0,priority:"medium"});const n=e.categoryBreakdown[0];return n&&n.percentage>50&&s.push({type:"warning",title:"消费过于集中",message:`${n.categoryName}占总消费的${n.percentage.toFixed(0)}%，建议分散消费`,actionable:!0,priority:"medium"}),s},k=(e,a,t)=>{const s=new Map,n=new Date(a);for(;n<=t;){const e=n.toISOString().split("T")[0];s.set(e,0),n.setDate(n.getDate()+1)}return e.forEach(e=>{try{const a=e.date instanceof Date?e.date:new Date(e.date);if(!isNaN(a.getTime())){const t=a.toISOString().split("T")[0];s.has(t)&&s.set(t,s.get(t)+e.amount)}}catch(a){}}),Array.from(s.values())},x=(e,a,t)=>{if(e.length<2)return{direction:"stable",averageDaily:0,maxDaily:0,minDaily:0,volatility:0,firstHalfAverage:0,secondHalfAverage:0,weekdayAverage:0,weekendAverage:0,momentum:0};const s=e.reduce((e,a)=>e+a,0)/e.length,n=Math.max(...e),l=Math.min(...e),r=e.reduce((e,a)=>e+Math.pow(a-s,2),0)/e.length,o=Math.sqrt(r),i=e.slice(0,Math.floor(e.length/2)),c=e.slice(Math.floor(e.length/2)),d=i.reduce((e,a)=>e+a,0)/i.length,u=c.reduce((e,a)=>e+a,0)/c.length,g=[],v=[],m=new Date(a);e.forEach((e,a)=>{const t=m.getDay();0===t||6===t?v.push(e):g.push(e),m.setDate(m.getDate()+1)});const h=g.length>0?g.reduce((e,a)=>e+a,0)/g.length:0,p=v.length>0?v.reduce((e,a)=>e+a,0)/v.length:0,y=Math.min(7,e.length),b=e.slice(-y),D=b.reduce((e,a)=>e+a,0)/b.length;let w="stable";const k=.1*s;return u>d+k?w="increasing":u<d-k&&(w="decreasing"),{direction:w,averageDaily:s,maxDaily:n,minDaily:l,volatility:o,firstHalfAverage:d,secondHalfAverage:u,weekdayAverage:h,weekendAverage:p,momentum:s>0?(D-s)/s*100:0}},f=(t,s)=>{const n=a(t.start,t.end),l=a(s.start,s.end),r=n.reduce((e,a)=>e+a.amount,0),o=l.reduce((e,a)=>e+a.amount,0),i=k(n,t.start,t.end),c=k(l,s.start,s.end),d=r-o,u=o>0?d/o*100:0,g=new Map,v=new Map;n.forEach(e=>{g.set(e.categoryId,(g.get(e.categoryId)||0)+e.amount)}),l.forEach(e=>{v.set(e.categoryId,(v.get(e.categoryId)||0)+e.amount)});const m=Array.from(new Set([...g.keys(),...v.keys()])).map(a=>{const t=e.value.find(e=>e.id===a),s=g.get(a)||0,n=v.get(a)||0,l=s-n,r=n>0?l/n*100:0;return{categoryId:a,categoryName:(null==t?void 0:t.name)||"未知分类",thisMonth:s,lastMonth:n,change:l,changePercentage:r}}).sort((e,a)=>Math.abs(a.change)-Math.abs(e.change));return{thisMonth:{total:r,count:n.length,period:`${t.start.getFullYear()}年${t.start.getMonth()+1}月`,averageDaily:i.length>0?r/i.length:0,maxDaily:Math.max(...i,0),minDaily:i.length>0?Math.min(...i.filter(e=>e>0)):0},lastMonth:{total:o,count:l.length,period:`${s.start.getFullYear()}年${s.start.getMonth()+1}月`,averageDaily:c.length>0?o/c.length:0,maxDaily:Math.max(...c,0),minDaily:c.length>0?Math.min(...c.filter(e=>e>0)):0},change:{amount:d,percentage:u,trend:d>0?"increase":d<0?"decrease":"stable"},categoryComparison:m}};return{currentPeriod:u(n),customStartDate:u(l),customEndDate:u(r),isLoading:u(o),error:u(i),currentDateRange:g,currentPeriodExpenses:v,categoryBreakdown:m,dailyTrend:h,currentStatistics:p,budgetAnalysis:y,historicalComparison:b,setPeriod:e=>{n.value=e},setCustomDateRange:(e,a)=>{l.value=e,r.value=a,n.value="custom"},getStatistics:D,getCategoryRanking:(e=5)=>m.value.slice(0,e),getTrendAnalysis:()=>{const e=h.value;if(e.length<2)return{direction:"stable",averageDaily:0,maxDaily:0,minDaily:0,volatility:0,firstHalfAverage:0,secondHalfAverage:0,weekdayAverage:0,weekendAverage:0,momentum:0};const a=e.map(e=>e.amount),t=a.reduce((e,a)=>e+a,0)/a.length,s=Math.max(...a),n=Math.min(...a),l=a.reduce((e,a)=>e+Math.pow(a-t,2),0)/a.length,r=Math.sqrt(l),o=a.slice(0,Math.floor(a.length/2)),i=a.slice(Math.floor(a.length/2)),c=o.reduce((e,a)=>e+a,0)/o.length,d=i.reduce((e,a)=>e+a,0)/i.length,u=[],g=[];e.forEach(e=>{const a=e.date.getDay();0===a||6===a?g.push(e.amount):u.push(e.amount)});const v=u.length>0?u.reduce((e,a)=>e+a,0)/u.length:0,m=g.length>0?g.reduce((e,a)=>e+a,0)/g.length:0,p=Math.min(7,a.length),y=a.slice(-p),b=y.reduce((e,a)=>e+a,0)/y.length;let D="stable";const w=.1*t;return d>c+w?D="increasing":d<c-w&&(D="decreasing"),{direction:D,averageDaily:t,maxDaily:s,minDaily:n,volatility:r,firstHalfAverage:c,secondHalfAverage:d,weekdayAverage:v,weekendAverage:m,momentum:t>0?(b-t)/t*100:0}},getCustomPeriodAnalysis:(e,t)=>{const s=Math.ceil((t.getTime()-e.getTime())/864e5)+1,n=D("custom",e,t),l=a(e,t),r=k(l,e,t),o=x(r,e),i=w(n,o);let c;if(s>=28&&s<=31){const a=new Date(e);a.setMonth(a.getMonth()-1);const s=new Date(t);s.setMonth(s.getMonth()-1),c=f({start:e,end:t},{start:a,end:s})}return{period:"custom",startDate:e,endDate:t,totalDays:s,statistics:n,comparison:c,trends:o,insights:i}},clearError:()=>{i.value=null}}}(),{categories:O,getCategoryById:H}=S(),R=c(!1),j=c(""),L=c(""),Y=d(()=>{switch(a.value){case"week":return"本周";case"month":default:return"本月";case"custom":const e=t.value.startDate,a=t.value.endDate;return`${J(e)} - ${J(a)}`}}),_=[{value:"week",label:"本周",icon:"📅"},{value:"month",label:"本月",icon:"📆"},{value:"custom",label:"自定义",icon:"🗓️"}],q=d(()=>{const e=s.value;if(0===e.length)return 0;const{startDate:a,endDate:n}=t.value,l=Math.ceil((n.getTime()-a.getTime())/864e5)+1;return e.reduce((e,a)=>e+a.amount,0)/l}),U=d(()=>P()),z=()=>{if(j.value&&L.value){const e=new Date(j.value),a=new Date(L.value);e<=a&&E(e,a)}},V=e=>e>=1e4?(e/1e4).toFixed(1)+"万":e>=1e3?(e/1e3).toFixed(1)+"k":e.toFixed(0),J=e=>`${e.getMonth()+1}/${e.getDate()}`,Z=e=>e.toISOString().split("T")[0],G=e=>{const a=H(e);return(null==a?void 0:a.icon)||"📝"},K=e=>{const a=H(e);return(null==a?void 0:a.color)||"#95A5A6"},Q=e=>{switch(e){case"increasing":return"📈";case"decreasing":return"📉";default:return"📊"}},W=e=>{switch(e){case"increasing":return"消费呈上升趋势";case"decreasing":return"消费呈下降趋势";default:return"消费相对稳定"}},X=e=>e>100?"over-budget":e>90?"warning":e>70?"normal":"good",ee=e=>{switch(e){case"high":return"高风险";case"medium":return"中风险";case"low":return"低风险";default:return"正常"}},ae=()=>{N()},te=e=>{},se=e=>{},ne=e=>{};return m(()=>{const e=new Date,a=new Date;a.setDate(e.getDate()-29),j.value=Z(a),L.value=Z(e)}),v(R,e=>{e&&"custom"===a.value&&(j.value=Z(t.value.startDate),L.value=Z(t.value.endDate))}),(e,t)=>(y(),p("div",Re,[b("div",je,[t[7]||(t[7]=b("h1",{class:"nav-title"},"统计分析",-1)),b("button",{class:"period-selector",onClick:t[0]||(t[0]=e=>R.value=!0)},[b("span",null,k(Y.value),1),t[6]||(t[6]=b("span",{class:"selector-arrow"},"▼",-1))])]),R.value?(y(),p("div",{key:0,class:"period-picker-overlay",onClick:t[5]||(t[5]=e=>R.value=!1)},[b("div",{class:"period-picker",onClick:t[4]||(t[4]=T(()=>{},["stop"]))},[b("div",Le,[t[8]||(t[8]=b("h3",null,"选择统计时间段",-1)),b("button",{class:"close-button",onClick:t[1]||(t[1]=e=>R.value=!1)},"✕")]),b("div",Ye,[(y(),p(D,null,w(_,e=>b("button",{key:e.value,class:A(["picker-option",{active:C(a)===e.value}]),onClick:a=>(e=>{if(M(e),"custom"===e){const e=new Date,a=new Date;a.setDate(e.getDate()-29),j.value=Z(a),L.value=Z(e),E(a,e)}R.value=!1})(e.value)},[b("span",qe,k(e.icon),1),b("span",Ue,k(e.label),1)],10,_e)),64))]),"custom"===C(a)?(y(),p("div",ze,[b("div",Ve,[t[9]||(t[9]=b("label",null,"开始日期",-1)),$(b("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>j.value=e),type:"date",class:"date-input",onChange:z},null,544),[[I,j.value]])]),b("div",Je,[t[10]||(t[10]=b("label",null,"结束日期",-1)),$(b("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>L.value=e),type:"date",class:"date-input",onChange:z},null,544),[[I,L.value]])])])):x("",!0)])])):x("",!0),b("div",Ze,[b("div",Ge,[b("div",Ke,[t[12]||(t[12]=b("div",{class:"card-icon"},"💰",-1)),b("div",Qe,[t[11]||(t[11]=b("div",{class:"card-label"},"总消费",-1)),b("div",We,"¥"+k(V(C(r).totalSpent)),1)])]),b("div",Xe,[t[14]||(t[14]=b("div",{class:"card-icon"},"📊",-1)),b("div",ea,[t[13]||(t[13]=b("div",{class:"card-label"},"消费笔数",-1)),b("div",aa,k(C(s).length)+"笔",1)])]),b("div",ta,[t[16]||(t[16]=b("div",{class:"card-icon"},"📈",-1)),b("div",sa,[t[15]||(t[15]=b("div",{class:"card-label"},"日均消费",-1)),b("div",na,"¥"+k(V(q.value)),1)])]),C(o)?(y(),p("div",la,[t[18]||(t[18]=b("div",{class:"card-icon"},"🎯",-1)),b("div",ra,[t[17]||(t[17]=b("div",{class:"card-label"},"预算达成率",-1)),b("div",oa,k(C(o).achievementRate.toFixed(1))+"%",1)])])):x("",!0)]),C(o)&&"month"===C(a)?(y(),p("div",ia,[t[28]||(t[28]=b("div",{class:"section-header"},[b("h2",{class:"section-title"},"预算执行情况")],-1)),b("div",ca,[b("div",da,[b("div",ua,[t[19]||(t[19]=b("span",{class:"progress-label"},"预算进度",-1)),b("span",ga,k(C(o).achievementRate.toFixed(1))+"%",1)]),b("div",{class:A(["progress-status",C(o).status])},k(C(o).message),3)]),b("div",va,[b("div",{class:A(["progress-fill",C(o).status]),style:f({width:Math.min(C(o).achievementRate,100)+"%"})},null,6),C(o).achievementRate>100?(y(),p("div",{key:0,class:"progress-overflow",style:f({width:C(o).achievementRate-100+"%"})},null,4)):x("",!0)]),b("div",ma,[b("div",ha,[t[20]||(t[20]=b("span",{class:"detail-label"},"已消费",-1)),b("span",pa,"¥"+k(V(C(o).totalSpent)),1)]),b("div",ya,[t[21]||(t[21]=b("span",{class:"detail-label"},"剩余预算",-1)),b("span",ba,"¥"+k(V(C(o).remainingBudget)),1)]),b("div",Da,[t[22]||(t[22]=b("span",{class:"detail-label"},"剩余天数",-1)),b("span",wa,k(C(o).daysRemaining)+"天",1)]),b("div",ka,[t[23]||(t[23]=b("span",{class:"detail-label"},"建议日消费",-1)),b("span",xa,"¥"+k(V(C(o).recommendedDailySpend)),1)])]),b("div",fa,[b("div",Ma,[b("div",Aa,[t[24]||(t[24]=b("span",{class:"analysis-label"},"预计月末消费",-1)),b("span",{class:A(["analysis-value",C(o).projectedMonthEnd>C(o).totalBudget?"over-budget":"normal"])}," ¥"+k(V(C(o).projectedMonthEnd)),3)]),b("div",Ca,[t[25]||(t[25]=b("span",{class:"analysis-label"},"风险等级",-1)),b("span",{class:A(["risk-badge",C(o).riskLevel])},k(ee(C(o).riskLevel)),3)])]),C(o).savingsOpportunity>0?(y(),p("div",$a,[t[27]||(t[27]=b("span",{class:"savings-icon"},"💡",-1)),b("div",Ia,[t[26]||(t[26]=b("span",{class:"savings-title"},"节省机会",-1)),b("span",Ta,"可节省 ¥"+k(V(C(o).savingsOpportunity)),1)])])):x("",!0)])])])):x("",!0),b("div",Fa,[t[29]||(t[29]=b("div",{class:"section-header"},[b("h2",{class:"section-title"},"消费分析")],-1)),F(He,{"category-breakdown":C(n),"daily-trend":C(l),categories:[...C(O)],"is-loading":C(g),error:C(h),onSegmentClick:te,onLegendClick:se,onBarClick:ne,onRetry:ae},null,8,["category-breakdown","daily-trend","categories","is-loading","error"])]),b("div",Sa,[t[31]||(t[31]=b("div",{class:"section-header"},[b("h2",{class:"section-title"},"消费排行"),b("span",{class:"section-subtitle"},"按分类统计")],-1)),0===C(n).length?(y(),p("div",Ba,[...t[30]||(t[30]=[b("span",{class:"empty-icon"},"📊",-1),b("p",null,"暂无消费数据",-1)])])):(y(),p("div",Ea,[(y(!0),p(D,null,w(C(n),(e,a)=>(y(),p("div",{key:e.categoryId,class:"ranking-item",onClick:e=>{}},[b("div",Na,k(a+1),1),b("div",Oa,[b("div",Ha,[b("span",Ra,k(G(e.categoryId)),1),b("span",ja,k(e.categoryName),1)]),b("div",La,[b("span",Ya,"¥"+k(V(e.amount)),1),b("span",_a,k(e.percentage.toFixed(1))+"%",1)])]),b("div",qa,[b("div",{class:"bar-fill",style:f({width:e.percentage+"%",backgroundColor:K(e.categoryId)})},null,4)])],8,Pa))),128))]))]),b("div",Ua,[t[40]||(t[40]=b("div",{class:"section-header"},[b("h2",{class:"section-title"},"趋势分析")],-1)),U.value?(y(),p("div",za,[b("div",Va,[b("div",{class:A(["trend-icon",U.value.direction])},k(Q(U.value.direction)),3),b("div",Ja,[t[32]||(t[32]=b("div",{class:"trend-label"},"消费趋势",-1)),b("div",Za,k(W(U.value.direction)),1)])]),b("div",Ga,[b("div",Ka,[t[33]||(t[33]=b("span",{class:"stat-label"},"日均消费",-1)),b("span",Qa,"¥"+k(V(U.value.averageDaily)),1)]),b("div",Wa,[t[34]||(t[34]=b("span",{class:"stat-label"},"最高单日",-1)),b("span",Xa,"¥"+k(V(U.value.maxDaily)),1)]),b("div",et,[t[35]||(t[35]=b("span",{class:"stat-label"},"最低单日",-1)),b("span",at,"¥"+k(V(U.value.minDaily)),1)])]),b("div",tt,[b("div",st,[b("div",nt,[t[36]||(t[36]=b("span",{class:"period-label"},"前半段平均",-1)),b("span",lt,"¥"+k(V(U.value.firstHalfAverage)),1)]),b("div",rt,[U.value.secondHalfAverage>U.value.firstHalfAverage?(y(),p("span",ot,"↗")):U.value.secondHalfAverage<U.value.firstHalfAverage?(y(),p("span",it,"↘")):(y(),p("span",ct,"→"))]),b("div",dt,[t[37]||(t[37]=b("span",{class:"period-label"},"后半段平均",-1)),b("span",ut,"¥"+k(V(U.value.secondHalfAverage)),1)])]),b("div",gt,[b("div",vt,[t[38]||(t[38]=b("span",{class:"comparison-label"},"工作日平均",-1)),b("span",mt,"¥"+k(V(U.value.weekdayAverage)),1)]),b("div",ht,[t[39]||(t[39]=b("span",{class:"comparison-label"},"周末平均",-1)),b("span",pt,"¥"+k(V(U.value.weekendAverage)),1)])]),Math.abs(U.value.momentum)>10?(y(),p("div",yt,[b("span",bt,k(U.value.momentum>0?"📈":"📉"),1),b("span",Dt," 最近消费"+k(U.value.momentum>0?"加速":"放缓")+"， 动量"+k(Math.abs(U.value.momentum).toFixed(1))+"% ",1)])):x("",!0)])])):x("",!0)]),C(i)&&"month"===C(a)?(y(),p("div",wt,[t[52]||(t[52]=b("div",{class:"section-header"},[b("h2",{class:"section-title"},"历史对比"),b("span",{class:"section-subtitle"},"与上月同期对比")],-1)),b("div",kt,[b("div",xt,[b("div",ft,[t[41]||(t[41]=b("div",{class:"period-label"},"本月",-1)),b("div",Mt,"¥"+k(V(C(i).thisMonth.total)),1),b("div",At,k(C(i).thisMonth.count)+"笔",1)]),b("div",Ct,["increase"===C(i).change.trend?(y(),p("span",$t,"↗")):"decrease"===C(i).change.trend?(y(),p("span",It,"↘")):(y(),p("span",Tt,"→"))]),b("div",Ft,[t[42]||(t[42]=b("div",{class:"period-label"},"上月",-1)),b("div",St,"¥"+k(V(C(i).lastMonth.total)),1),b("div",Bt,k(C(i).lastMonth.count)+"笔",1)])]),b("div",Et,[b("div",{class:A(["change-amount",C(i).change.trend])},k(C(i).change.amount>=0?"+":"")+"¥"+k(V(Math.abs(C(i).change.amount))),3),b("div",{class:A(["change-percentage",C(i).change.trend])},k(C(i).change.percentage>=0?"+":"")+k(C(i).change.percentage.toFixed(1))+"% ",3)])]),b("div",Pt,[b("div",Nt,[b("div",Ot,[t[44]||(t[44]=b("span",{class:"metric-label"},"日均消费对比",-1)),b("div",Ht,[b("span",Rt,"¥"+k(V(C(i).thisMonth.averageDaily)),1),t[43]||(t[43]=b("span",{class:"vs-text"},"vs",-1)),b("span",jt,"¥"+k(V(C(i).lastMonth.averageDaily)),1)])]),b("div",Lt,[t[46]||(t[46]=b("span",{class:"metric-label"},"最高单日消费",-1)),b("div",Yt,[b("span",_t,"¥"+k(V(C(i).thisMonth.maxDaily)),1),t[45]||(t[45]=b("span",{class:"vs-text"},"vs",-1)),b("span",qt,"¥"+k(V(C(i).lastMonth.maxDaily)),1)])])])]),C(i).budgetComparison?(y(),p("div",Ut,[t[50]||(t[50]=b("h3",{class:"comparison-subtitle"},"预算执行对比",-1)),b("div",zt,[b("div",Vt,[t[47]||(t[47]=b("span",{class:"budget-label"},"本月预算达成率",-1)),b("span",{class:A(["budget-value",X(C(i).budgetComparison.thisMonthAchievement)])},k(C(i).budgetComparison.thisMonthAchievement.toFixed(1))+"% ",3)]),b("div",Jt,[t[48]||(t[48]=b("span",{class:"budget-label"},"上月预算达成率",-1)),b("span",{class:A(["budget-value",X(C(i).budgetComparison.lastMonthAchievement)])},k(C(i).budgetComparison.lastMonthAchievement.toFixed(1))+"% ",3)]),b("div",Zt,[t[49]||(t[49]=b("span",{class:"change-label"},"达成率变化",-1)),b("span",{class:A(["change-value",C(i).budgetComparison.achievementChange>=0?"increase":"decrease"])},k(C(i).budgetComparison.achievementChange>=0?"+":"")+k(C(i).budgetComparison.achievementChange.toFixed(1))+"% ",3)])])])):x("",!0),C(i).categoryComparison.length>0?(y(),p("div",Gt,[t[51]||(t[51]=b("h3",{class:"comparison-subtitle"},"分类变化",-1)),b("div",Kt,[(y(!0),p(D,null,w(C(i).categoryComparison.slice(0,5),e=>(y(),p("div",{key:e.categoryId,class:"comparison-item"},[b("div",Qt,[b("span",Wt,k(G(e.categoryId)),1),b("span",Xt,k(e.categoryName),1)]),b("div",es,[b("span",{class:A(["value-change",e.change>=0?"increase":"decrease"])},k(e.change>=0?"+":"")+"¥"+k(V(Math.abs(e.change))),3),b("span",{class:A(["percentage-change",e.changePercentage>=0?"increase":"decrease"])},k(e.changePercentage>=0?"+":"")+k(e.changePercentage.toFixed(1))+"% ",3)])]))),128))])])):x("",!0)])):x("",!0)])]))}}),[["__scopeId","data-v-67758b24"]]);export{as as default};
