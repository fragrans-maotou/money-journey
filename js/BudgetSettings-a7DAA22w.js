var e=(e,s,t)=>new Promise((a,l)=>{var n=e=>{try{o(t.next(e))}catch(s){l(s)}},i=e=>{try{o(t.throw(e))}catch(s){l(s)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((t=t.apply(e,s)).next())});import{d as s,e as t,f as a,g as l,i as n,r as i,c as o,h as d,s as u,j as c,p as r,C as v,w as p,v as g,n as h,y as m,t as y,F as b,m as f,z as _,A as w,o as k,x,I as B,J as S,K as C,L as z,u as D}from"./vue-vendor-GQR5GLLq.js";import{A as I}from"./AmountInput-kU8B6T6k.js";import{_ as O}from"./index-DLCvt2vX.js";import{u as M}from"./useBudget-BWijnOHX.js";import"./useStorage-CghUNedP.js";const A=O(s({__name:"IOSSpinner",props:{size:{default:20}},setup:e=>(e,s)=>(a(),t("div",{class:"ios-spinner",style:l({width:`${e.size}px`,height:`${e.size}px`})},[...s[0]||(s[0]=[n("svg",{class:"ios-spinner__svg",viewBox:"0 0 24 24",fill:"none"},[n("circle",{class:"ios-spinner__circle",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-dasharray":"31.416","stroke-dashoffset":"31.416"})],-1)])],4))}),[["__scopeId","data-v-6197a216"]]),F=["disabled"],j={key:0,class:"ios-button__spinner"},L={key:1,class:"ios-button__content"},Y=O(s({__name:"IOSButton",props:{variant:{default:"primary"},size:{default:"medium"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:s}){const l=e,n=s,r=i(!1),v=o(()=>["ios-button",`ios-button--${l.variant}`,`ios-button--${l.size}`,{"ios-button--disabled":l.disabled,"ios-button--loading":l.loading,"ios-button--full-width":l.fullWidth,"ios-button--pressed":r.value}]),p=o(()=>{switch(l.size){case"small":return 16;case"large":return 24;default:return 20}}),g=e=>{l.disabled||l.loading||n("click",e)},h=()=>{l.disabled||l.loading||(r.value=!0)},m=()=>{r.value=!1};return(e,s)=>(a(),t("button",{class:d(v.value),disabled:e.disabled,onClick:g,onTouchstart:h,onTouchend:m},[e.loading?(a(),t("span",j,[u(A,{size:p.value},null,8,["size"])])):(a(),t("span",L,[c(e.$slots,"default",{},void 0)]))],42,F))}}),[["__scopeId","data-v-c76802a2"]]),$={key:0,class:"ios-action-sheet__header"},T={key:0,class:"ios-action-sheet__title"},U={key:1,class:"ios-action-sheet__message"},V={class:"ios-action-sheet__actions"},E=["onClick"],q={key:0,class:"ios-action-sheet__action-icon"},N={class:"ios-action-sheet__action-text"},P={key:1,class:"ios-action-sheet__cancel"},R=O(s({__name:"IOSActionSheet",props:{visible:{type:Boolean},title:{},message:{},actions:{},showCancel:{type:Boolean,default:!0},cancelText:{default:"取消"},closeOnOverlay:{type:Boolean,default:!0}},emits:["update:visible","cancel","action"],setup(s,{emit:l}){const o=s,c=l,w=i(),k=e=>["ios-action-sheet__action",{"ios-action-sheet__action--destructive":"destructive"===e.type,"ios-action-sheet__action--disabled":"disabled"===e.type}],x=()=>{o.closeOnOverlay&&S()},B=()=>{c("cancel"),S()},S=()=>{c("update:visible",!1)},C=s=>e(null,null,function*(){yield h();const e=s.querySelector(".ios-action-sheet");e&&(e.style.transform="translateY(0)")}),z=e=>{const s=e.querySelector(".ios-action-sheet");s&&(s.style.transform="translateY(100%)")},D=e=>{"Escape"===e.key&&S()};return"undefined"!=typeof window&&document.addEventListener("keydown",D),(s,l)=>(a(),r(g,{to:"body"},[u(v,{name:"ios-action-sheet",onEnter:C,onLeave:z},{default:p(()=>[s.visible?(a(),t("div",{key:0,class:"ios-action-sheet-overlay",onClick:x,onTouchmove:l[1]||(l[1]=_(()=>{},["prevent"]))},[n("div",{ref_key:"actionSheetRef",ref:w,class:"ios-action-sheet",onClick:l[0]||(l[0]=_(()=>{},["stop"]))},[s.title||s.message?(a(),t("div",$,[s.title?(a(),t("h3",T,y(s.title),1)):m("",!0),s.message?(a(),t("p",U,y(s.message),1)):m("",!0)])):m("",!0),n("div",V,[(a(!0),t(b,null,f(s.actions,(s,l)=>(a(),t("button",{key:l,class:d(k(s)),onClick:t=>(s=>e(null,null,function*(){if("disabled"===s.type)return;const e=o.actions.indexOf(s);c("action",s,e),s.handler&&(yield s.handler()),S()}))(s)},[s.icon?(a(),t("span",q,y(s.icon),1)):m("",!0),n("span",N,y(s.text),1)],10,E))),128))]),s.showCancel?(a(),t("div",P,[n("button",{class:"ios-action-sheet__cancel-button",onClick:B},y(s.cancelText),1)])):m("",!0)],512)],32)):m("",!0)]),_:1})]))}}),[["__scopeId","data-v-63639064"]]),W={class:"budget-settings"},J={class:"settings-content"},K={class:"settings-section"},G={class:"budget-form"},H={class:"budget-period"},Q={class:"period-info"},X={class:"period-value"},Z={class:"settings-section"},ee={class:"warning-settings"},se={class:"warning-item"},te={class:"warning-control"},ae={class:"threshold-slider"},le=["disabled"],ne={class:"threshold-value"},ie={class:"warning-item"},oe={class:"warning-control"},de={class:"ios-switch"},ue=["disabled"],ce={key:0,class:"settings-section"},re={class:"budget-status"},ve={class:"status-grid"},pe={class:"status-item"},ge={class:"status-value"},he={class:"status-item"},me={class:"status-value"},ye={class:"status-item"},be={class:"status-item"},fe={class:"status-value"},_e={class:"usage-progress"},we={class:"progress-bar"},ke={class:"progress-text"},xe={class:"settings-actions"},Be=O(s({__name:"BudgetSettings",setup(s){const c=D(),{currentBudget:v,budgetSummary:g,isLoading:h,error:b,setMonthlyBudget:f,updateMonthlyBudget:_,deleteBudget:O,clearError:A}=M(),F=i(0),j=i(""),L=i(80),$=i(!0),T=i(null),U=i(!1),V=i(!1),E=o(()=>F.value>0&&!j.value&&!h.value),q=[{text:"本月",type:"default",handler:()=>Ce({id:"current"})},{text:"下月",type:"default",handler:()=>Ce({id:"next"})},{text:"自定义周期",type:"default",handler:()=>Ce({id:"custom"})}],N=[{text:"删除预算",type:"destructive",handler:()=>ze({id:"delete"})},{text:"取消",type:"default",handler:()=>ze({id:"cancel"})}],P=e=>{j.value="",e<=0?j.value="预算金额必须大于0":e>999999.99&&(j.value="预算金额不能超过999,999.99")},Be=()=>{},Se=()=>{},Ce=e=>{switch(e.id){case"current":T.value=Oe();break;case"next":T.value=function(){const e=new Date,s=new Date(e.getFullYear(),e.getMonth()+1,1),t=new Date(e.getFullYear(),e.getMonth()+2,0);return{start:s,end:t}}()}U.value=!1},ze=s=>e(null,null,function*(){if("delete"===s.id&&v.value)try{yield O(v.value.id),c.push("/")}catch(e){}V.value=!1}),De=()=>e(null,null,function*(){var e;if(E.value){A();try{const s={monthlyAmount:F.value,startDate:(null==(e=T.value)?void 0:e.start)||new Date};v.value?yield _({monthlyAmount:F.value}):yield f(s),c.push("/")}catch(s){}}});function Ie(e){return e.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}function Oe(){const e=new Date;return{start:new Date(e.getFullYear(),e.getMonth(),1),end:new Date(e.getFullYear(),e.getMonth()+1,0)}}return w(b,e=>{e&&(j.value=e)}),k(()=>{v.value?(F.value=v.value.monthlyAmount,T.value={start:v.value.startDate,end:v.value.endDate}):T.value=Oe()}),(e,s)=>{return a(),t("div",W,[s[21]||(s[21]=n("div",{class:"settings-header"},[n("h1",null,"预算设置"),n("p",{class:"settings-subtitle"},"管理您的月度预算和预警设置")],-1)),n("div",J,[n("div",K,[s[9]||(s[9]=n("div",{class:"section-header"},[n("h2",null,"月度预算"),n("p",null,"设置您的月度预算金额")],-1)),n("div",G,[u(I,{modelValue:F.value,"onUpdate:modelValue":s[0]||(s[0]=e=>F.value=e),placeholder:"请输入预算金额",error:j.value,hint:"建议根据您的月收入合理设置预算",disabled:x(h),onInput:P},null,8,["modelValue","error","disabled"]),n("div",H,[n("div",Q,[s[7]||(s[7]=n("span",{class:"period-label"},"预算周期",-1)),n("span",X,y((i=T.value,null==i?void 0:i.start.toLocaleDateString("zh-CN",{month:"long",year:"numeric"}))),1)]),u(Y,{variant:"tertiary",size:"small",onClick:s[1]||(s[1]=e=>U.value=!0)},{default:p(()=>[...s[8]||(s[8]=[z(" 更改 ",-1)])]),_:1})])])]),n("div",Z,[s[13]||(s[13]=n("div",{class:"section-header"},[n("h2",null,"预算预警"),n("p",null,"当预算使用达到设定比例时提醒您")],-1)),n("div",ee,[n("div",se,[s[10]||(s[10]=n("div",{class:"warning-info"},[n("span",{class:"warning-label"},"预警阈值"),n("span",{class:"warning-desc"},"预算使用比例达到此值时提醒")],-1)),n("div",te,[n("div",ae,[B(n("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>L.value=e),type:"range",min:"50",max:"95",step:"5",class:"slider",disabled:x(h),onInput:Be},null,40,le),[[S,L.value]]),n("div",ne,y(L.value)+"%",1)])])]),n("div",ie,[s[12]||(s[12]=n("div",{class:"warning-info"},[n("span",{class:"warning-label"},"每日提醒"),n("span",{class:"warning-desc"},"每天检查预算使用情况并提醒")],-1)),n("div",oe,[n("label",de,[B(n("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>$.value=e),type:"checkbox",disabled:x(h),onChange:Se},null,40,ue),[[C,$.value]]),s[11]||(s[11]=n("span",{class:"switch-slider"},null,-1))])])])])]),x(g).totalBudget>0?(a(),t("div",ce,[s[18]||(s[18]=n("div",{class:"section-header"},[n("h2",null,"当前预算状态"),n("p",null,"本月预算使用情况概览")],-1)),n("div",re,[n("div",ve,[n("div",pe,[s[14]||(s[14]=n("span",{class:"status-label"},"总预算",-1)),n("span",ge,"¥"+y(Ie(x(g).totalBudget)),1)]),n("div",he,[s[15]||(s[15]=n("span",{class:"status-label"},"已使用",-1)),n("span",me,"¥"+y(Ie(x(g).totalSpent)),1)]),n("div",ye,[s[16]||(s[16]=n("span",{class:"status-label"},"剩余",-1)),n("span",{class:d(["status-value",{negative:x(g).remainingBudget<0}])}," ¥"+y(Ie(x(g).remainingBudget)),3)]),n("div",be,[s[17]||(s[17]=n("span",{class:"status-label"},"剩余天数",-1)),n("span",fe,y(x(g).daysRemaining)+"天",1)])]),n("div",_e,[n("div",we,[n("div",{class:d(["progress-fill",{warning:x(g).totalSpent/x(g).totalBudget*100>=L.value,exceeded:x(g).isOverBudget}]),style:l({width:`${Math.min(100,x(g).totalSpent/x(g).totalBudget*100)}%`})},null,6)]),n("span",ke," 已使用 "+y(Math.round(x(g).totalSpent/x(g).totalBudget*100))+"% ",1)])])])):m("",!0),n("div",xe,[u(Y,{variant:"primary",size:"large",loading:x(h),disabled:!E.value,onClick:De},{default:p(()=>[...s[19]||(s[19]=[z(" 保存设置 ",-1)])]),_:1},8,["loading","disabled"]),x(g).totalBudget>0?(a(),r(Y,{key:0,variant:"destructive",size:"large",disabled:x(h),onClick:s[4]||(s[4]=e=>V.value=!0)},{default:p(()=>[...s[20]||(s[20]=[z(" 删除预算 ",-1)])]),_:1},8,["disabled"])):m("",!0)])]),u(R,{visible:U.value,"onUpdate:visible":s[5]||(s[5]=e=>U.value=e),title:"选择预算周期",actions:q},null,8,["visible"]),u(R,{visible:V.value,"onUpdate:visible":s[6]||(s[6]=e=>V.value=e),title:"删除预算",message:"删除后将清空所有预算数据，此操作不可恢复",actions:N},null,8,["visible"])]);var i}}}),[["__scopeId","data-v-56f7f504"]]);export{Be as default};
