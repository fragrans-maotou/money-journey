import{d as a,c as s,e,f as t,g as l,i as r,y as i,t as o,h as u,s as n,o as d,x as c,p as g,u as v}from"./vue-vendor-GQR5GLLq.js";import{u as p}from"./useBudget-BWijnOHX.js";import{u as m}from"./useExpense-oBx4eHDE.js";import{_ as b}from"./index-DLCvt2vX.js";import"./useStorage-CghUNedP.js";const h=["width","height"],y=["cx","cy","r","stroke-width"],k=["cx","cy","r","stroke-width","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap"],f={class:"progress-ring-content"},x={class:"progress-percentage"},F={key:0,class:"progress-label"},B=b(a({__name:"ProgressRing",props:{progress:{},size:{default:120},strokeWidth:{default:8},color:{default:"#007AFF"},backgroundColor:{default:"#F2F2F7"},strokeLinecap:{default:"round"},label:{},animated:{type:Boolean,default:!0}},setup(a){const u=a,n=s(()=>u.size/2),d=s(()=>(u.size-u.strokeWidth)/2),c=s(()=>2*Math.PI*d.value),g=s(()=>{const a=Math.max(0,Math.min(100,u.progress));return c.value-a/100*c.value});return(a,s)=>(t(),e("div",{class:"progress-ring",style:l({width:`${a.size}px`,height:`${a.size}px`})},[(t(),e("svg",{width:a.size,height:a.size,class:"progress-ring-svg",style:{transform:"rotate(-90deg)"}},[r("circle",{cx:n.value,cy:n.value,r:d.value,"stroke-width":a.strokeWidth,stroke:"#F2F2F7",fill:"transparent",class:"progress-ring-background"},null,8,y),r("circle",{cx:n.value,cy:n.value,r:d.value,"stroke-width":a.strokeWidth,stroke:a.color,fill:"transparent","stroke-dasharray":c.value,"stroke-dashoffset":g.value,"stroke-linecap":a.strokeLinecap,class:"progress-ring-progress"},null,8,k)],8,h)),r("div",f,[r("div",x,o(Math.round(a.progress))+"% ",1),a.label?(t(),e("div",F,o(a.label),1)):i("",!0)])],4))}}),[["__scopeId","data-v-25e1a1cc"]]),S={class:"budget-card"},C={class:"budget-card-header"},_={class:"budget-amount"},w={class:"amount"},z={class:"budget-progress"},M={class:"progress-info"},D={class:"spent-amount"},j={class:"value"},L={class:"remaining-amount"},I={class:"value"},P={class:"budget-details"},W={class:"detail-item"},E={class:"detail-value"},A={class:"detail-item"},N={class:"detail-value"},O={class:"detail-item"},R=b(a({__name:"BudgetCard",props:{budgetSummary:{},availableBudget:{}},setup(a){const l=a,i=s(()=>0===l.budgetSummary.totalBudget?0:Math.min(100,l.budgetSummary.totalSpent/l.budgetSummary.totalBudget*100)),d=s(()=>{const a=i.value;return a>=100?"#FF3B30":a>=80?"#FF9500":a>=60?"#FFCC00":"#34C759"}),c=s(()=>l.budgetSummary.isOverBudget?"status-exceeded":i.value>=80?"status-warning":"status-normal"),g=s(()=>l.budgetSummary.isOverBudget?"已超支":i.value>=80?"接近预算":"正常"),v=a=>a.toLocaleString("zh-CN",{minimumFractionDigits:0,maximumFractionDigits:2});return(a,s)=>(t(),e("div",S,[r("div",C,[s[0]||(s[0]=r("h3",{class:"budget-title"},"本月预算",-1)),r("div",{class:u(["budget-status",c.value])},o(g.value),3)]),r("div",_,[s[1]||(s[1]=r("span",{class:"currency"},"¥",-1)),r("span",w,o(v(a.budgetSummary.totalBudget)),1)]),r("div",z,[n(B,{progress:i.value,size:120,"stroke-width":8,color:d.value},null,8,["progress","color"]),r("div",M,[r("div",D,[s[2]||(s[2]=r("span",{class:"label"},"已消费",-1)),r("span",j,"¥"+o(v(a.budgetSummary.totalSpent)),1)]),r("div",L,[s[3]||(s[3]=r("span",{class:"label"},"剩余",-1)),r("span",I,"¥"+o(v(a.budgetSummary.remainingBudget)),1)])])]),r("div",P,[r("div",W,[s[4]||(s[4]=r("span",{class:"detail-label"},"日均预算",-1)),r("span",E,"¥"+o(v(a.budgetSummary.dailyAverage)),1)]),r("div",A,[s[5]||(s[5]=r("span",{class:"detail-label"},"剩余天数",-1)),r("span",N,o(a.budgetSummary.daysRemaining)+"天",1)]),r("div",O,[s[6]||(s[6]=r("span",{class:"detail-label"},"今日可用",-1)),r("span",{class:u(["detail-value",{"over-budget":a.availableBudget<0}])}," ¥"+o(v(Math.abs(a.availableBudget))),3)])])]))}}),[["__scopeId","data-v-c0008024"]]),$={class:"dashboard"},q={class:"dashboard-header"},G={class:"header-actions"},H=["disabled"],J={class:"dashboard-content"},K={key:1,class:"no-budget-state"},Q={key:2,class:"today-budget"},T={class:"today-info"},U={class:"today-available"},V={key:0,class:"today-spent"},X={class:"amount"},Y={key:3,class:"quick-actions"},Z={key:4,class:"error-state"},aa={class:"error-message"},sa=b(a({__name:"Dashboard",setup(a){const l=v(),{currentBudget:n,isLoading:b,error:h,budgetSummary:y,availableBudget:k,getCurrentMonthBudget:f,clearError:x}=p(),{getExpensesByDate:F}=m(),B=s(()=>F(new Date).reduce((a,s)=>a+s.amount,0)),S=()=>{return a=null,s=null,e=function*(){try{yield f()}catch(a){}},new Promise((t,l)=>{var r=a=>{try{o(e.next(a))}catch(s){l(s)}},i=a=>{try{o(e.throw(a))}catch(s){l(s)}},o=a=>a.done?t(a.value):Promise.resolve(a.value).then(r,i);o((e=e.apply(a,s)).next())});var a,s,e},C=()=>{l.push("/budget-settings")},_=()=>{l.push("/expense-record")},w=()=>{l.push("/statistics")},z=a=>a.toLocaleString("zh-CN",{minimumFractionDigits:0,maximumFractionDigits:2});return d(()=>{S()}),(a,s)=>(t(),e("div",$,[r("div",q,[s[1]||(s[1]=r("h1",null,"预算概览",-1)),r("div",G,[r("button",{class:"refresh-button",onClick:S,disabled:c(b)},[r("span",{class:u(["refresh-icon",{spinning:c(b)}])},"🔄",2)],8,H)])]),r("div",J,[c(n)?(t(),g(R,{key:0,"budget-summary":c(y),"available-budget":c(k)},null,8,["budget-summary","available-budget"])):(t(),e("div",K,[s[2]||(s[2]=r("div",{class:"no-budget-icon"},"💰",-1)),s[3]||(s[3]=r("h3",null,"还没有设置预算",-1)),s[4]||(s[4]=r("p",null,"设置月度预算，开始管理您的支出",-1)),r("button",{class:"setup-budget-button",onClick:C}," 设置预算 ")])),c(n)?(t(),e("div",Q,[s[7]||(s[7]=r("h3",null,"今日预算",-1)),r("div",T,[r("div",U,[s[5]||(s[5]=r("span",{class:"label"},"可用金额",-1)),r("span",{class:u(["amount",{"over-budget":c(k)<0}])}," ¥"+o(z(Math.abs(c(k)))),3)]),B.value>0?(t(),e("div",V,[s[6]||(s[6]=r("span",{class:"label"},"今日已消费",-1)),r("span",X,"¥"+o(z(B.value)),1)])):i("",!0)])])):i("",!0),c(n)?(t(),e("div",Y,[s[10]||(s[10]=r("h3",null,"快速操作",-1)),r("div",{class:"action-buttons"},[r("button",{class:"action-button",onClick:_},[...s[8]||(s[8]=[r("span",{class:"action-icon"},"➕",-1),r("span",{class:"action-text"},"记录消费",-1)])]),r("button",{class:"action-button",onClick:w},[...s[9]||(s[9]=[r("span",{class:"action-icon"},"📊",-1),r("span",{class:"action-text"},"查看统计",-1)])])])])):i("",!0),c(h)?(t(),e("div",Z,[r("div",aa,o(c(h)),1),r("button",{class:"retry-button",onClick:s[0]||(s[0]=(...a)=>c(x)&&c(x)(...a))}," 重试 ")])):i("",!0)])]))}}),[["__scopeId","data-v-d87a3fdd"]]);export{sa as default};
